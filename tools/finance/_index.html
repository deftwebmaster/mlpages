<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FinanceSmart Calculator Suite | Your Money, Your Math</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .tool-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .tool-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 12px rgba(0,0,0,0.15);
            border-color: #10b981;
        }

        .tool-card h3 {
            color: #10b981;
            font-size: 1.4rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .tool-card p {
            color: #666;
            line-height: 1.6;
        }

        .calculator {
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            display: none;
        }

        .calculator.active {
            display: block;
        }

        .calculator h2 {
            color: #10b981;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        .back-button {
            background: #6b7280;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            margin-bottom: 20px;
            font-size: 1rem;
            transition: background 0.3s;
        }

        .back-button:hover {
            background: #4b5563;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #374151;
        }

        .input-group input,
        .input-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e5e7eb;
            border-radius: 6px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: #10b981;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .toggle-btn {
            flex: 1;
            min-width: 120px;
            padding: 12px 20px;
            border: 2px solid #e5e7eb;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            font-weight: 600;
        }

        .toggle-btn.active {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border-color: #10b981;
        }

        .toggle-btn:hover:not(.active) {
            border-color: #10b981;
        }

        .calculate-btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .calculate-btn:hover {
            transform: scale(1.02);
        }

        .results {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
            border-radius: 8px;
            border-left: 4px solid #10b981;
        }

        .results h3 {
            color: #059669;
            margin-bottom: 15px;
            font-size: 1.4rem;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 12px 0;
            border-bottom: 1px solid #d1fae5;
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-label {
            font-weight: 600;
            color: #374151;
        }

        .result-value {
            font-weight: 700;
            color: #059669;
            font-size: 1.1rem;
        }

        .warning {
            background: #fef3c7;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
        }

        .warning p {
            color: #92400e;
            font-weight: 600;
        }

        .success {
            background: #d1fae5;
            border-left: 4px solid #10b981;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
        }

        .success p {
            color: #065f46;
            font-weight: 600;
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        .comparison-card {
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #e5e7eb;
        }

        .comparison-card h4 {
            margin-bottom: 15px;
            color: #374151;
        }

        .subscription-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            border: 2px solid #e5e7eb;
            border-radius: 6px;
            margin-bottom: 10px;
        }

        .subscription-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .subscription-item label {
            flex: 1;
            cursor: pointer;
            margin: 0;
            font-weight: normal;
        }

        .subscription-price {
            font-weight: 600;
            color: #059669;
        }

        .split-input {
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 10px;
            align-items: end;
        }

        .historical-table {
            width: 100%;
            margin-top: 20px;
            border-collapse: collapse;
        }

        .historical-table th,
        .historical-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e5e7eb;
        }

        .historical-table th {
            background: #f9fafb;
            font-weight: 600;
            color: #374151;
        }

        .historical-table tr:hover {
            background: #f9fafb;
        }

        @media (max-width: 768px) {
            header h1 {
                font-size: 1.8rem;
            }

            header p {
                font-size: 1rem;
            }

            .dashboard {
                grid-template-columns: 1fr;
            }

            .comparison-grid {
                grid-template-columns: 1fr;
            }

            .button-group {
                flex-direction: column;
            }

            .toggle-btn {
                width: 100%;
            }
        }

        .info-box {
            background: #eff6ff;
            border-left: 4px solid #3b82f6;
            padding: 15px;
            border-radius: 6px;
            margin-bottom: 20px;
        }

        .info-box p {
            color: #1e40af;
            line-height: 1.6;
        }

        .chart-container {
            margin-top: 20px;
            padding: 20px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
        }

        canvas {
            max-width: 100%;
            height: auto !important;
        }

        .state-select {
            width: 100%;
        }

        .additional-costs {
            margin-top: 20px;
            padding: 15px;
            background: #f9fafb;
            border-radius: 6px;
        }

        .additional-costs h4 {
            margin-bottom: 10px;
            color: #374151;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üí∞ FinanceSmart Calculator Suite</h1>
            <p>Your Money, Your Math, Your Future</p>
        </header>

        <div id="dashboard" class="dashboard">
            <div class="tool-card" onclick="showCalculator('inflation')">
                <h3>üíµ Inflation Calculator</h3>
                <p>See what money was really worth. Compare purchasing power across decades and understand the true impact of inflation.</p>
            </div>

            <div class="tool-card" onclick="showCalculator('subscription')">
                <h3>üì∫ Split Subscription Calculator</h3>
                <p>Stop overpaying for shared streaming. Calculate fair splits and see how much you're really spending.</p>
            </div>

            <div class="tool-card" onclick="showCalculator('loan')">
                <h3>üí≥ Loan Payment Calculator</h3>
                <p>Understand the true cost of borrowing. See how interest rates and loan terms affect your payments.</p>
            </div>

            <div class="tool-card" onclick="showCalculator('carlease')">
                <h3>üöó Buy vs Lease Calculator</h3>
                <p>Should you buy or lease that car? Compare long-term costs and equity to make the smart choice.</p>
            </div>

            <div class="tool-card" onclick="showCalculator('rentbuy')">
                <h3>üè† Rent vs Buy Calculator</h3>
                <p>Is homeownership worth it? Factor in all the hidden costs and see when buying makes sense.</p>
            </div>

            <div class="tool-card" onclick="showCalculator('sidehustle')">
                <h3>üí∏ Side Hustle Profitability</h3>
                <p>Is that side gig worth your time? Calculate your real hourly rate after expenses and taxes.</p>
            </div>
        </div>

        <!-- Inflation Calculator -->
        <div id="inflation-calculator" class="calculator">
            <button class="back-button" onclick="showDashboard()">‚Üê Back to Dashboard</button>
            <h2>üíµ Inflation Calculator</h2>
            
            <div class="info-box">
                <p>Understanding inflation helps you see the real value of money over time. A dollar in 1970 bought much more than a dollar today.</p>
            </div>

            <div class="button-group">
                <button class="toggle-btn active" onclick="switchInflationMode('historical')">Historical Value</button>
                <button class="toggle-btn" onclick="switchInflationMode('future')">Future Value</button>
                <button class="toggle-btn" onclick="switchInflationMode('purchasing')">Purchasing Power</button>
            </div>

            <div id="historical-mode">
                <div class="input-group">
                    <label>Amount</label>
                    <input type="number" id="historical-amount" value="100" min="0" step="0.01">
                </div>

                <div class="input-group">
                    <label>From Year</label>
                    <select id="historical-from-year"></select>
                </div>

                <div class="input-group">
                    <label>To Year</label>
                    <select id="historical-to-year"></select>
                </div>

                <button class="calculate-btn" onclick="calculateHistoricalInflation()">Calculate Value</button>
            </div>

            <div id="future-mode" style="display:none;">
                <div class="input-group">
                    <label>Current Amount</label>
                    <input type="number" id="future-amount" value="100" min="0" step="0.01">
                </div>

                <div class="input-group">
                    <label>Years into Future</label>
                    <input type="number" id="future-years" value="10" min="1" max="50">
                </div>

                <div class="input-group">
                    <label>Expected Annual Inflation Rate (%)</label>
                    <input type="number" id="future-rate" value="3" min="0" max="20" step="0.1">
                </div>

                <button class="calculate-btn" onclick="calculateFutureInflation()">Calculate Future Value</button>
            </div>

            <div id="purchasing-mode" style="display:none;">
                <div class="input-group">
                    <label>Select Item Category</label>
                    <select id="purchasing-item" onchange="updatePurchasingPower()">
                        <option value="gas">Gasoline (per gallon)</option>
                        <option value="milk">Milk (per gallon)</option>
                        <option value="bread">Bread (loaf)</option>
                        <option value="movie">Movie Ticket</option>
                        <option value="car">New Car (average)</option>
                        <option value="house">Median Home Price</option>
                        <option value="wage">Minimum Wage (hourly)</option>
                    </select>
                </div>

                <div class="input-group">
                    <label>Compare Years</label>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <select id="purchasing-year1"></select>
                        <select id="purchasing-year2"></select>
                    </div>
                </div>

                <button class="calculate-btn" onclick="calculatePurchasingPower()">Compare Purchasing Power</button>
            </div>

            <div id="inflation-results"></div>
        </div>

        <!-- Subscription Calculator -->
        <div id="subscription-calculator" class="calculator">
            <button class="back-button" onclick="showDashboard()">‚Üê Back to Dashboard</button>
            <h2>üì∫ Split Subscription Calculator</h2>

            <div class="info-box">
                <p>Select your subscriptions below and see the total cost. Then split it fairly among everyone sharing.</p>
            </div>

            <h3 style="margin-bottom: 15px;">Select Your Subscriptions</h3>
            <div id="subscription-list"></div>

            <div class="input-group" style="margin-top: 20px;">
                <label>Add Custom Subscription</label>
                <div style="display: grid; grid-template-columns: 2fr 1fr auto; gap: 10px;">
                    <input type="text" id="custom-sub-name" placeholder="Service name">
                    <input type="number" id="custom-sub-price" placeholder="Price" step="0.01">
                    <button class="toggle-btn" onclick="addCustomSubscription()">Add</button>
                </div>
            </div>

            <div class="input-group">
                <label>Number of People Splitting</label>
                <input type="number" id="split-people" value="1" min="1" max="20">
            </div>

            <button class="calculate-btn" onclick="calculateSubscriptions()">Calculate Split</button>

            <div id="subscription-results"></div>
        </div>

        <!-- Loan Calculator -->
        <div id="loan-calculator" class="calculator">
            <button class="back-button" onclick="showDashboard()">‚Üê Back to Dashboard</button>
            <h2>üí≥ Loan Payment Calculator</h2>

            <div class="button-group">
                <button class="toggle-btn active" onclick="switchLoanType('auto')">Auto Loan</button>
                <button class="toggle-btn" onclick="switchLoanType('student')">Student Loan</button>
                <button class="toggle-btn" onclick="switchLoanType('mortgage')">Mortgage</button>
            </div>

            <div id="auto-loan">
                <div class="input-group">
                    <label>Car Price</label>
                    <input type="number" id="auto-price" value="30000" min="0" step="100">
                </div>

                <div class="input-group">
                    <label>Down Payment</label>
                    <input type="number" id="auto-down" value="5000" min="0" step="100">
                </div>

                <div class="input-group">
                    <label>Interest Rate (APR %)</label>
                    <input type="number" id="auto-rate" value="6" min="0" max="30" step="0.1">
                </div>

                <div class="input-group">
                    <label>Loan Term (months)</label>
                    <select id="auto-term">
                        <option value="36">36 months (3 years)</option>
                        <option value="48">48 months (4 years)</option>
                        <option value="60" selected>60 months (5 years)</option>
                        <option value="72">72 months (6 years)</option>
                        <option value="84">84 months (7 years)</option>
                    </select>
                </div>
            </div>

            <div id="student-loan" style="display:none;">
                <div class="input-group">
                    <label>Total Loan Amount</label>
                    <input type="number" id="student-amount" value="35000" min="0" step="100">
                </div>

                <div class="input-group">
                    <label>Interest Rate (APR %)</label>
                    <input type="number" id="student-rate" value="5" min="0" max="30" step="0.1">
                </div>

                <div class="input-group">
                    <label>Loan Term (years)</label>
                    <select id="student-term">
                        <option value="10" selected>10 years</option>
                        <option value="15">15 years</option>
                        <option value="20">20 years</option>
                        <option value="25">25 years</option>
                    </select>
                </div>
            </div>

            <div id="mortgage-loan" style="display:none;">
                <div class="input-group">
                    <label>Home Price</label>
                    <input type="number" id="mortgage-price" value="350000" min="0" step="1000">
                </div>

                <div class="input-group">
                    <label>Down Payment</label>
                    <input type="number" id="mortgage-down" value="70000" min="0" step="1000">
                </div>

                <div class="input-group">
                    <label>Interest Rate (APR %)</label>
                    <input type="number" id="mortgage-rate" value="7" min="0" max="30" step="0.1">
                </div>

                <div class="input-group">
                    <label>Loan Term (years)</label>
                    <select id="mortgage-term">
                        <option value="15">15 years</option>
                        <option value="20">20 years</option>
                        <option value="30" selected>30 years</option>
                    </select>
                </div>

                <div class="input-group">
                    <label>Annual Property Tax (%)</label>
                    <input type="number" id="mortgage-tax" value="1.2" min="0" max="5" step="0.1">
                </div>

                <div class="input-group">
                    <label>Annual Insurance</label>
                    <input type="number" id="mortgage-insurance" value="1800" min="0" step="100">
                </div>

                <div class="input-group">
                    <label>Monthly HOA (if applicable)</label>
                    <input type="number" id="mortgage-hoa" value="0" min="0" step="10">
                </div>
            </div>

            <button class="calculate-btn" onclick="calculateLoan()">Calculate Payment</button>

            <div id="loan-results"></div>
        </div>

        <!-- Car Lease Calculator -->
        <div id="carlease-calculator" class="calculator">
            <button class="back-button" onclick="showDashboard()">‚Üê Back to Dashboard</button>
            <h2>üöó Buy vs Lease Calculator</h2>

            <div class="info-box">
                <p>Leasing means lower monthly payments but no equity. Buying costs more upfront but you own the car. Let's compare.</p>
            </div>

            <div class="input-group">
                <label>Car Price (MSRP)</label>
                <input type="number" id="car-price" value="30000" min="0" step="100">
            </div>

            <h3 style="margin-top: 30px; margin-bottom: 15px; color: #059669;">Buying Option</h3>
            
            <div class="input-group">
                <label>Down Payment</label>
                <input type="number" id="buy-down" value="5000" min="0" step="100">
            </div>

            <div class="input-group">
                <label>Interest Rate (APR %)</label>
                <input type="number" id="buy-rate" value="6" min="0" max="30" step="0.1">
            </div>

            <div class="input-group">
                <label>Loan Term (months)</label>
                <select id="buy-term">
                    <option value="36">36 months</option>
                    <option value="48">48 months</option>
                    <option value="60" selected>60 months</option>
                    <option value="72">72 months</option>
                </select>
            </div>

            <h3 style="margin-top: 30px; margin-bottom: 15px; color: #059669;">Leasing Option</h3>

            <div class="input-group">
                <label>Down Payment (Cap Reduction)</label>
                <input type="number" id="lease-down" value="2000" min="0" step="100">
            </div>

            <div class="input-group">
                <label>Monthly Lease Payment</label>
                <input type="number" id="lease-payment" value="350" min="0" step="10">
            </div>

            <div class="input-group">
                <label>Lease Term (months)</label>
                <select id="lease-term">
                    <option value="24">24 months</option>
                    <option value="36" selected>36 months</option>
                    <option value="48">48 months</option>
                </select>
            </div>

            <div class="input-group">
                <label>Expected Depreciation Rate (% per year)</label>
                <input type="number" id="car-depreciation" value="15" min="0" max="50" step="1">
            </div>

            <button class="calculate-btn" onclick="calculateCarLease()">Compare Buy vs Lease</button>

            <div id="carlease-results"></div>
        </div>

        <!-- Rent vs Buy Calculator -->
        <div id="rentbuy-calculator" class="calculator">
            <button class="back-button" onclick="showDashboard()">‚Üê Back to Dashboard</button>
            <h2>üè† Rent vs Buy Calculator</h2>

            <div class="info-box">
                <p>Renting is simpler but builds no equity. Buying has hidden costs but can build wealth. Let's crunch the numbers.</p>
            </div>

            <h3 style="margin-bottom: 15px; color: #059669;">Rental Option</h3>

            <div class="input-group">
                <label>Monthly Rent</label>
                <input type="number" id="monthly-rent" value="1800" min="0" step="50">
            </div>

            <div class="input-group">
                <label>Annual Rent Increase (%)</label>
                <input type="number" id="rent-increase" value="3" min="0" max="20" step="0.5">
            </div>

            <div class="input-group">
                <label>Renters Insurance (monthly)</label>
                <input type="number" id="renters-insurance" value="20" min="0" step="5">
            </div>

            <h3 style="margin-top: 30px; margin-bottom: 15px; color: #059669;">Buying Option</h3>

            <div class="input-group">
                <label>Home Price</label>
                <input type="number" id="home-price" value="350000" min="0" step="1000">
            </div>

            <div class="input-group">
                <label>Down Payment</label>
                <input type="number" id="home-down" value="70000" min="0" step="1000">
            </div>

            <div class="input-group">
                <label>Mortgage Rate (APR %)</label>
                <input type="number" id="home-rate" value="7" min="0" max="30" step="0.1">
            </div>

            <div class="input-group">
                <label>Loan Term (years)</label>
                <select id="home-term">
                    <option value="15">15 years</option>
                    <option value="30" selected>30 years</option>
                </select>
            </div>

            <div class="input-group">
                <label>State</label>
                <select id="home-state" class="state-select"></select>
            </div>

            <div class="input-group">
                <label>Additional Local Property Tax (%)</label>
                <input type="number" id="home-local-tax" value="0" min="0" max="5" step="0.1">
            </div>

            <div class="input-group">
                <label>Monthly HOA</label>
                <input type="number" id="home-hoa" value="200" min="0" step="10">
            </div>

            <div class="input-group">
                <label>Annual Home Insurance</label>
                <input type="number" id="home-insurance" value="1800" min="0" step="100">
            </div>

            <div class="input-group">
                <label>Annual Maintenance (% of home value)</label>
                <input type="number" id="home-maintenance" value="1" min="0" max="5" step="0.1">
            </div>

            <div class="input-group">
                <label>Expected Home Appreciation (% per year)</label>
                <input type="number" id="home-appreciation" value="3" min="0" max="20" step="0.5">
            </div>

            <div class="input-group">
                <label>Years to Compare</label>
                <select id="comparison-years">
                    <option value="5">5 years</option>
                    <option value="10" selected>10 years</option>
                    <option value="15">15 years</option>
                    <option value="20">20 years</option>
                    <option value="30">30 years</option>
                </select>
            </div>

            <button class="calculate-btn" onclick="calculateRentBuy()">Compare Rent vs Buy</button>

            <div id="rentbuy-results"></div>
        </div>

        <!-- Side Hustle Calculator -->
        <div id="sidehustle-calculator" class="calculator">
            <button class="back-button" onclick="showDashboard()">‚Üê Back to Dashboard</button>
            <h2>üí∏ Side Hustle Profitability Calculator</h2>

            <div class="info-box">
                <p>Calculate your real hourly rate after expenses and taxes. Is that side gig actually worth your time?</p>
            </div>

            <div class="input-group">
                <label>Monthly Gross Income</label>
                <input type="number" id="hustle-income" value="2000" min="0" step="50">
            </div>

            <div class="input-group">
                <label>Hours Worked Per Month</label>
                <input type="number" id="hustle-hours" value="40" min="0" step="1">
            </div>

            <h3 style="margin-top: 30px; margin-bottom: 15px; color: #059669;">Monthly Expenses</h3>

            <div class="input-group">
                <label>Gas/Transportation</label>
                <input type="number" id="hustle-gas" value="100" min="0" step="10">
            </div>

            <div class="input-group">
                <label>Supplies/Materials</label>
                <input type="number" id="hustle-supplies" value="50" min="0" step="10">
            </div>

            <div class="input-group">
                <label>Software/Subscriptions</label>
                <input type="number" id="hustle-software" value="30" min="0" step="10">
            </div>

            <div class="input-group">
                <label>Other Expenses</label>
                <input type="number" id="hustle-other" value="20" min="0" step="10">
            </div>

            <div class="input-group">
                <label>Estimated Tax Rate (%)</label>
                <input type="number" id="hustle-tax" value="30" min="0" max="50" step="1">
            </div>

            <div class="input-group">
                <label>Your Day Job Hourly Rate (for comparison)</label>
                <input type="number" id="hustle-dayjob" value="22" min="0" step="0.50">
            </div>

            <button class="calculate-btn" onclick="calculateSideHustle()">Calculate Profitability</button>

            <div id="sidehustle-results"></div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        // Data Storage
        let userData = JSON.parse(localStorage.getItem('financesmart') || '{}');

        function saveData() {
            localStorage.setItem('financesmart', JSON.stringify(userData));
        }

        // Historical CPI data (1913-2024) - Annual average
        const cpiData = {
            1913: 9.9, 1914: 10.0, 1915: 10.1, 1916: 10.9, 1917: 12.8, 1918: 15.1, 1919: 17.3, 1920: 20.0,
            1921: 17.9, 1922: 16.8, 1923: 17.1, 1924: 17.1, 1925: 17.5, 1926: 17.7, 1927: 17.4, 1928: 17.1,
            1929: 17.1, 1930: 16.7, 1931: 15.2, 1932: 13.7, 1933: 13.0, 1934: 13.4, 1935: 13.7, 1936: 13.9,
            1937: 14.4, 1938: 14.1, 1939: 13.9, 1940: 14.0, 1941: 14.7, 1942: 16.3, 1943: 17.3, 1944: 17.6,
            1945: 18.0, 1946: 19.5, 1947: 22.3, 1948: 24.1, 1949: 23.8, 1950: 24.1, 1951: 26.0, 1952: 26.5,
            1953: 26.7, 1954: 26.9, 1955: 26.8, 1956: 27.2, 1957: 28.1, 1958: 28.9, 1959: 29.1, 1960: 29.6,
            1961: 29.9, 1962: 30.2, 1963: 30.6, 1964: 31.0, 1965: 31.5, 1966: 32.4, 1967: 33.4, 1968: 34.8,
            1969: 36.7, 1970: 38.8, 1971: 40.5, 1972: 41.8, 1973: 44.4, 1974: 49.3, 1975: 53.8, 1976: 56.9,
            1977: 60.6, 1978: 65.2, 1979: 72.6, 1980: 82.4, 1981: 90.9, 1982: 96.5, 1983: 99.6, 1984: 103.9,
            1985: 107.6, 1986: 109.6, 1987: 113.6, 1988: 118.3, 1989: 124.0, 1990: 130.7, 1991: 136.2, 1992: 140.3,
            1993: 144.5, 1994: 148.2, 1995: 152.4, 1996: 156.9, 1997: 160.5, 1998: 163.0, 1999: 166.6, 2000: 172.2,
            2001: 177.1, 2002: 179.9, 2003: 184.0, 2004: 188.9, 2005: 195.3, 2006: 201.6, 2007: 207.3, 2008: 215.3,
            2009: 214.5, 2010: 218.1, 2011: 224.9, 2012: 229.6, 2013: 233.0, 2014: 236.7, 2015: 237.0, 2016: 240.0,
            2017: 245.1, 2018: 251.1, 2019: 255.7, 2020: 258.8, 2021: 271.0, 2022: 292.7, 2023: 304.7, 2024: 314.2
        };

        // Historical prices for purchasing power comparisons
        const historicalPrices = {
            gas: { 1950: 0.27, 1960: 0.31, 1970: 0.36, 1980: 1.25, 1990: 1.16, 2000: 1.51, 2010: 2.79, 2020: 2.17, 2024: 3.50 },
            milk: { 1950: 0.82, 1960: 1.00, 1970: 1.32, 1980: 2.16, 1990: 2.78, 2000: 2.79, 2010: 3.26, 2020: 3.54, 2024: 4.20 },
            bread: { 1950: 0.14, 1960: 0.20, 1970: 0.25, 1980: 0.50, 1990: 0.70, 2000: 0.91, 2010: 1.38, 2020: 1.50, 2024: 2.00 },
            movie: { 1950: 0.48, 1960: 0.69, 1970: 1.55, 1980: 2.69, 1990: 4.23, 2000: 5.39, 2010: 7.89, 2020: 9.16, 2024: 15.00 },
            car: { 1950: 1500, 1960: 2600, 1970: 3500, 1980: 7200, 1990: 16000, 2000: 22000, 2010: 29000, 2020: 40000, 2024: 48000 },
            house: { 1950: 7400, 1960: 11900, 1970: 17000, 1980: 47200, 1990: 79100, 2000: 119600, 2010: 173100, 2020: 269000, 2024: 420000 },
            wage: { 1950: 0.75, 1960: 1.00, 1970: 1.60, 1980: 3.10, 1990: 3.80, 2000: 5.15, 2010: 7.25, 2020: 7.25, 2024: 7.25 }
        };

        // Common subscriptions with current prices
        const commonSubscriptions = [
            { name: 'Netflix Premium', price: 22.99 },
            { name: 'Netflix Standard', price: 15.49 },
            { name: 'Netflix Basic', price: 6.99 },
            { name: 'Disney+ (with ads)', price: 7.99 },
            { name: 'Disney+ (no ads)', price: 13.99 },
            { name: 'Disney+ Bundle', price: 14.99 },
            { name: 'Hulu (with ads)', price: 7.99 },
            { name: 'Hulu (no ads)', price: 17.99 },
            { name: 'HBO Max (with ads)', price: 9.99 },
            { name: 'HBO Max (no ads)', price: 15.99 },
            { name: 'Amazon Prime Video', price: 8.99 },
            { name: 'Apple TV+', price: 9.99 },
            { name: 'Peacock Premium', price: 5.99 },
            { name: 'Paramount+ (with ads)', price: 5.99 },
            { name: 'Paramount+ (no ads)', price: 11.99 },
            { name: 'Spotify Premium', price: 10.99 },
            { name: 'Spotify Family', price: 16.99 },
            { name: 'Apple Music Individual', price: 10.99 },
            { name: 'Apple Music Family', price: 16.99 },
            { name: 'YouTube Premium', price: 13.99 },
            { name: 'YouTube Premium Family', price: 22.99 },
            { name: 'Audible', price: 14.95 }
        ];

        // State property tax rates (average %)
        const stateTaxRates = {
            'Alabama': 0.41, 'Alaska': 1.19, 'Arizona': 0.62, 'Arkansas': 0.62, 'California': 0.76,
            'Colorado': 0.51, 'Connecticut': 2.14, 'Delaware': 0.57, 'Florida': 0.89, 'Georgia': 0.92,
            'Hawaii': 0.28, 'Idaho': 0.69, 'Illinois': 2.27, 'Indiana': 0.85, 'Iowa': 1.57,
            'Kansas': 1.41, 'Kentucky': 0.86, 'Louisiana': 0.55, 'Maine': 1.36, 'Maryland': 1.09,
            'Massachusetts': 1.23, 'Michigan': 1.54, 'Minnesota': 1.12, 'Mississippi': 0.79, 'Missouri': 0.97,
            'Montana': 0.84, 'Nebraska': 1.73, 'Nevada': 0.60, 'New Hampshire': 2.18, 'New Jersey': 2.49,
            'New Mexico': 0.80, 'New York': 1.72, 'North Carolina': 0.84, 'North Dakota': 0.98, 'Ohio': 1.56,
            'Oklahoma': 0.90, 'Oregon': 0.97, 'Pennsylvania': 1.58, 'Rhode Island': 1.63, 'South Carolina': 0.57,
            'South Dakota': 1.31, 'Tennessee': 0.71, 'Texas': 1.80, 'Utah': 0.60, 'Vermont': 1.90,
            'Virginia': 0.82, 'Washington': 0.98, 'West Virginia': 0.59, 'Wisconsin': 1.85, 'Wyoming': 0.61
        };

        // Navigation
        function showCalculator(id) {
            document.getElementById('dashboard').style.display = 'none';
            document.querySelectorAll('.calculator').forEach(calc => calc.classList.remove('active'));
            document.getElementById(id + '-calculator').classList.add('active');
        }

        function showDashboard() {
            document.getElementById('dashboard').style.display = 'grid';
            document.querySelectorAll('.calculator').forEach(calc => calc.classList.remove('active'));
        }

        // Initialize year dropdowns
        function initializeYearDropdowns() {
            const currentYear = 2024;
            const years = Object.keys(cpiData).sort((a, b) => b - a);
            
            const selects = ['historical-from-year', 'historical-to-year', 'purchasing-year1', 'purchasing-year2'];
            selects.forEach(id => {
                const select = document.getElementById(id);
                years.forEach(year => {
                    const option = document.createElement('option');
                    option.value = year;
                    option.textContent = year;
                    if ((id === 'historical-from-year' || id === 'purchasing-year1') && year == 1970) {
                        option.selected = true;
                    }
                    if ((id === 'historical-to-year' || id === 'purchasing-year2') && year == currentYear) {
                        option.selected = true;
                    }
                    select.appendChild(option);
                });
            });

            // Initialize state dropdown
            const stateSelect = document.getElementById('home-state');
            Object.keys(stateTaxRates).sort().forEach(state => {
                const option = document.createElement('option');
                option.value = state;
                option.textContent = state;
                if (state === 'Texas') option.selected = true;
                stateSelect.appendChild(option);
            });
        }

        // Initialize subscriptions list
        function initializeSubscriptions() {
            const container = document.getElementById('subscription-list');
            commonSubscriptions.forEach((sub, index) => {
                const div = document.createElement('div');
                div.className = 'subscription-item';
                div.innerHTML = `
                    <input type="checkbox" id="sub-${index}" data-price="${sub.price}">
                    <label for="sub-${index}">${sub.name}</label>
                    <span class="subscription-price">$${sub.price.toFixed(2)}/mo</span>
                `;
                container.appendChild(div);
            });
        }

        // Inflation Calculator Functions
        function switchInflationMode(mode) {
            document.querySelectorAll('#inflation-calculator .toggle-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            document.getElementById('historical-mode').style.display = mode === 'historical' ? 'block' : 'none';
            document.getElementById('future-mode').style.display = mode === 'future' ? 'block' : 'none';
            document.getElementById('purchasing-mode').style.display = mode === 'purchasing' ? 'block' : 'none';
        }

        function calculateHistoricalInflation() {
            const amount = parseFloat(document.getElementById('historical-amount').value);
            const fromYear = parseInt(document.getElementById('historical-from-year').value);
            const toYear = parseInt(document.getElementById('historical-to-year').value);

            const fromCPI = cpiData[fromYear];
            const toCPI = cpiData[toYear];
            const adjustedValue = amount * (toCPI / fromCPI);
            const inflationRate = ((toCPI / fromCPI - 1) * 100);

            const resultsDiv = document.getElementById('inflation-results');
            resultsDiv.innerHTML = `
                <div class="results">
                    <h3>Results</h3>
                    <div class="result-item">
                        <span class="result-label">$${amount.toFixed(2)} in ${fromYear}</span>
                        <span class="result-value">$${adjustedValue.toFixed(2)} in ${toYear}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Cumulative Inflation</span>
                        <span class="result-value">${inflationRate.toFixed(2)}%</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Purchasing Power Change</span>
                        <span class="result-value">${inflationRate > 0 ? 'DOWN' : 'UP'} ${Math.abs(inflationRate).toFixed(2)}%</span>
                    </div>
                </div>
            `;
        }

        function calculateFutureInflation() {
            const amount = parseFloat(document.getElementById('future-amount').value);
            const years = parseInt(document.getElementById('future-years').value);
            const rate = parseFloat(document.getElementById('future-rate').value) / 100;

            const futureValue = amount * Math.pow(1 + rate, years);
            const totalInflation = ((futureValue / amount - 1) * 100);

            const resultsDiv = document.getElementById('inflation-results');
            resultsDiv.innerHTML = `
                <div class="results">
                    <h3>Future Value Projection</h3>
                    <div class="result-item">
                        <span class="result-label">Today's Value</span>
                        <span class="result-value">$${amount.toFixed(2)}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Value in ${years} years</span>
                        <span class="result-value">$${futureValue.toFixed(2)}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Total Inflation</span>
                        <span class="result-value">${totalInflation.toFixed(2)}%</span>
                    </div>
                    <div class="warning">
                        <p>To maintain purchasing power, you'd need $${futureValue.toFixed(2)} in ${years} years to buy what $${amount.toFixed(2)} buys today.</p>
                    </div>
                </div>
            `;
        }

        function calculatePurchasingPower() {
            const item = document.getElementById('purchasing-item').value;
            const year1 = parseInt(document.getElementById('purchasing-year1').value);
            const year2 = parseInt(document.getElementById('purchasing-year2').value);

            const prices = historicalPrices[item];
            const price1 = getClosestPrice(prices, year1);
            const price2 = getClosestPrice(prices, year2);
            
            const percentChange = ((price2 - price1) / price1 * 100);
            const itemName = document.getElementById('purchasing-item').options[document.getElementById('purchasing-item').selectedIndex].text;

            const resultsDiv = document.getElementById('inflation-results');
            resultsDiv.innerHTML = `
                <div class="results">
                    <h3>Purchasing Power Comparison: ${itemName}</h3>
                    <div class="result-item">
                        <span class="result-label">${year1} Price</span>
                        <span class="result-value">$${price1.toFixed(2)}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">${year2} Price</span>
                        <span class="result-value">$${price2.toFixed(2)}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Price Change</span>
                        <span class="result-value">${percentChange > 0 ? '+' : ''}${percentChange.toFixed(2)}%</span>
                    </div>
                    <div class="${percentChange > 0 ? 'warning' : 'success'}">
                        <p>${itemName} ${percentChange > 0 ? 'increased' : 'decreased'} by $${Math.abs(price2 - price1).toFixed(2)} (${Math.abs(percentChange).toFixed(1)}%) from ${year1} to ${year2}.</p>
                    </div>
                </div>
            `;
        }

        function getClosestPrice(prices, year) {
            if (prices[year]) return prices[year];
            
            const years = Object.keys(prices).map(Number).sort((a, b) => a - b);
            let closest = years[0];
            let minDiff = Math.abs(year - closest);
            
            for (let y of years) {
                const diff = Math.abs(year - y);
                if (diff < minDiff) {
                    minDiff = diff;
                    closest = y;
                }
            }
            return prices[closest];
        }

        // Subscription Calculator Functions
        function addCustomSubscription() {
            const name = document.getElementById('custom-sub-name').value.trim();
            const price = parseFloat(document.getElementById('custom-sub-price').value);

            if (!name || !price || price <= 0) {
                alert('Please enter a valid subscription name and price.');
                return;
            }

            const container = document.getElementById('subscription-list');
            const index = Date.now();
            const div = document.createElement('div');
            div.className = 'subscription-item';
            div.innerHTML = `
                <input type="checkbox" id="sub-${index}" data-price="${price}" checked>
                <label for="sub-${index}">${name}</label>
                <span class="subscription-price">$${price.toFixed(2)}/mo</span>
            `;
            container.appendChild(div);

            document.getElementById('custom-sub-name').value = '';
            document.getElementById('custom-sub-price').value = '';
        }

        function calculateSubscriptions() {
            const checkboxes = document.querySelectorAll('#subscription-list input[type="checkbox"]:checked');
            const splitPeople = parseInt(document.getElementById('split-people').value);
            
            let total = 0;
            let subscriptions = [];

            checkboxes.forEach(cb => {
                const price = parseFloat(cb.dataset.price);
                const name = cb.nextElementSibling.textContent;
                total += price;
                subscriptions.push({ name, price });
            });

            const perPerson = total / splitPeople;
            const annual = total * 12;
            const annualPerPerson = perPerson * 12;

            const resultsDiv = document.getElementById('subscription-results');
            let subscriptionList = subscriptions.map(sub => 
                `<div class="result-item">
                    <span class="result-label">${sub.name}</span>
                    <span class="result-value">$${sub.price.toFixed(2)}/mo</span>
                </div>`
            ).join('');

            resultsDiv.innerHTML = `
                <div class="results">
                    <h3>Selected Subscriptions</h3>
                    ${subscriptionList}
                    <hr style="margin: 20px 0; border: none; border-top: 2px solid #d1fae5;">
                    <div class="result-item">
                        <span class="result-label">Total Monthly Cost</span>
                        <span class="result-value">$${total.toFixed(2)}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Total Annual Cost</span>
                        <span class="result-value">$${annual.toFixed(2)}</span>
                    </div>
                    ${splitPeople > 1 ? `
                        <hr style="margin: 20px 0; border: none; border-top: 2px solid #d1fae5;">
                        <h3 style="margin-top: 20px;">Split ${splitPeople} Ways</h3>
                        <div class="result-item">
                            <span class="result-label">Cost Per Person (Monthly)</span>
                            <span class="result-value">$${perPerson.toFixed(2)}</span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">Cost Per Person (Annual)</span>
                            <span class="result-value">$${annualPerPerson.toFixed(2)}</span>
                        </div>
                        <div class="success">
                            <p>Each person saves $${((total - perPerson) * 12).toFixed(2)} per year by splitting!</p>
                        </div>
                    ` : ''}
                </div>
            `;
        }

        // Loan Calculator Functions
        function switchLoanType(type) {
            document.querySelectorAll('#loan-calculator .toggle-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            document.getElementById('auto-loan').style.display = type === 'auto' ? 'block' : 'none';
            document.getElementById('student-loan').style.display = type === 'student' ? 'block' : 'none';
            document.getElementById('mortgage-loan').style.display = type === 'mortgage' ? 'block' : 'none';
        }

        function calculateLoan() {
            const activeBtn = document.querySelector('#loan-calculator .toggle-btn.active');
            const loanType = activeBtn.textContent.toLowerCase().includes('auto') ? 'auto' : 
                           activeBtn.textContent.toLowerCase().includes('student') ? 'student' : 'mortgage';

            if (loanType === 'auto') {
                calculateAutoLoan();
            } else if (loanType === 'student') {
                calculateStudentLoan();
            } else {
                calculateMortgage();
            }
        }

        function calculateAutoLoan() {
            const price = parseFloat(document.getElementById('auto-price').value);
            const down = parseFloat(document.getElementById('auto-down').value);
            const rate = parseFloat(document.getElementById('auto-rate').value) / 100 / 12;
            const term = parseInt(document.getElementById('auto-term').value);

            const principal = price - down;
            const payment = principal * (rate * Math.pow(1 + rate, term)) / (Math.pow(1 + rate, term) - 1);
            const totalPaid = payment * term;
            const totalInterest = totalPaid - principal;
            const totalCost = totalPaid + down;

            // Compare different terms
            const compareTerm = term === 60 ? 72 : 60;
            const compareRate = rate;
            const comparePayment = principal * (compareRate * Math.pow(1 + compareRate, compareTerm)) / (Math.pow(1 + compareRate, compareTerm) - 1);
            const compareTotalInterest = (comparePayment * compareTerm) - principal;
            const difference = Math.abs(totalInterest - compareTotalInterest);

            const resultsDiv = document.getElementById('loan-results');
            resultsDiv.innerHTML = `
                <div class="results">
                    <h3>Auto Loan Results</h3>
                    <div class="result-item">
                        <span class="result-label">Monthly Payment</span>
                        <span class="result-value">$${payment.toFixed(2)}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Total Interest Paid</span>
                        <span class="result-value">$${totalInterest.toFixed(2)}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Total Amount Paid</span>
                        <span class="result-value">$${totalCost.toFixed(2)}</span>
                    </div>
                    <div class="comparison-grid">
                        <div class="comparison-card">
                            <h4>${term} months (Current)</h4>
                            <div class="result-item">
                                <span class="result-label">Monthly</span>
                                <span class="result-value">$${payment.toFixed(2)}</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Interest</span>
                                <span class="result-value">$${totalInterest.toFixed(2)}</span>
                            </div>
                        </div>
                        <div class="comparison-card">
                            <h4>${compareTerm} months</h4>
                            <div class="result-item">
                                <span class="result-label">Monthly</span>
                                <span class="result-value">$${comparePayment.toFixed(2)}</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Interest</span>
                                <span class="result-value">$${compareTotalInterest.toFixed(2)}</span>
                            </div>
                        </div>
                    </div>
                    ${totalInterest < compareTotalInterest ? 
                        `<div class="success">
                            <p>Your ${term}-month term saves you $${difference.toFixed(2)} compared to ${compareTerm} months!</p>
                        </div>` :
                        `<div class="warning">
                            <p>A ${compareTerm}-month term would save you $${difference.toFixed(2)} but costs $${Math.abs(payment - comparePayment).toFixed(2)} more monthly.</p>
                        </div>`
                    }
                </div>
            `;
        }

        function calculateStudentLoan() {
            const amount = parseFloat(document.getElementById('student-amount').value);
            const rate = parseFloat(document.getElementById('student-rate').value) / 100 / 12;
            const years = parseInt(document.getElementById('student-term').value);
            const term = years * 12;

            const payment = amount * (rate * Math.pow(1 + rate, term)) / (Math.pow(1 + rate, term) - 1);
            const totalPaid = payment * term;
            const totalInterest = totalPaid - amount;

            // Extra payment scenario
            const extraPayment = 50;
            let balance = amount;
            let months = 0;
            let extraInterest = 0;

            while (balance > 0 && months < term) {
                const interest = balance * rate;
                extraInterest += interest;
                balance = balance + interest - payment - extraPayment;
                months++;
                if (balance < 0) balance = 0;
            }

            const savedInterest = totalInterest - extraInterest;
            const savedTime = term - months;

            const resultsDiv = document.getElementById('loan-results');
            resultsDiv.innerHTML = `
                <div class="results">
                    <h3>Student Loan Results</h3>
                    <div class="result-item">
                        <span class="result-label">Monthly Payment</span>
                        <span class="result-value">$${payment.toFixed(2)}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Total Interest Paid</span>
                        <span class="result-value">$${totalInterest.toFixed(2)}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Total Amount Paid</span>
                        <span class="result-value">$${totalPaid.toFixed(2)}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Payoff Date</span>
                        <span class="result-value">${years} years</span>
                    </div>
                    <div class="success">
                        <p><strong>Pay just $${extraPayment} extra per month:</strong><br>
                        Save $${savedInterest.toFixed(2)} in interest and pay off ${savedTime} months (${(savedTime/12).toFixed(1)} years) earlier!</p>
                    </div>
                </div>
            `;
        }

        function calculateMortgage() {
            const price = parseFloat(document.getElementById('mortgage-price').value);
            const down = parseFloat(document.getElementById('mortgage-down').value);
            const rate = parseFloat(document.getElementById('mortgage-rate').value) / 100 / 12;
            const years = parseInt(document.getElementById('mortgage-term').value);
            const term = years * 12;
            const taxRate = parseFloat(document.getElementById('mortgage-tax').value) / 100;
            const insurance = parseFloat(document.getElementById('mortgage-insurance').value);
            const hoa = parseFloat(document.getElementById('mortgage-hoa').value);

            const principal = price - down;
            const monthlyPI = principal * (rate * Math.pow(1 + rate, term)) / (Math.pow(1 + rate, term) - 1);
            const monthlyTax = (price * taxRate) / 12;
            const monthlyInsurance = insurance / 12;
            const totalMonthly = monthlyPI + monthlyTax + monthlyInsurance + hoa;

            const totalPaid = monthlyPI * term;
            const totalInterest = totalPaid - principal;

            // First year breakdown
            let balance = principal;
            let firstYearPrincipal = 0;
            let firstYearInterest = 0;

            for (let i = 0; i < 12; i++) {
                const interest = balance * rate;
                const principalPaid = monthlyPI - interest;
                firstYearInterest += interest;
                firstYearPrincipal += principalPaid;
                balance -= principalPaid;
            }

            const resultsDiv = document.getElementById('loan-results');
            resultsDiv.innerHTML = `
                <div class="results">
                    <h3>Mortgage Results</h3>
                    <div class="result-item">
                        <span class="result-label">Monthly Payment (P&I)</span>
                        <span class="result-value">$${monthlyPI.toFixed(2)}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Property Tax</span>
                        <span class="result-value">$${monthlyTax.toFixed(2)}/mo</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Insurance</span>
                        <span class="result-value">$${monthlyInsurance.toFixed(2)}/mo</span>
                    </div>
                    ${hoa > 0 ? `
                        <div class="result-item">
                            <span class="result-label">HOA</span>
                            <span class="result-value">$${hoa.toFixed(2)}/mo</span>
                        </div>
                    ` : ''}
                    <div class="result-item" style="border-top: 2px solid #059669; margin-top: 10px; padding-top: 15px;">
                        <span class="result-label"><strong>Total Monthly (PITI)</strong></span>
                        <span class="result-value" style="font-size: 1.3rem;">$${totalMonthly.toFixed(2)}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Total Interest (${years} years)</span>
                        <span class="result-value">$${totalInterest.toFixed(2)}</span>
                    </div>
                    <div class="warning">
                        <p><strong>First Year Breakdown:</strong><br>
                        Principal paid: $${firstYearPrincipal.toFixed(2)}<br>
                        Interest paid: $${firstYearInterest.toFixed(2)}<br>
                        Most of your payment goes to interest early on!</p>
                    </div>
                </div>
            `;
        }

        // Car Lease Calculator
        function calculateCarLease() {
            const carPrice = parseFloat(document.getElementById('car-price').value);
            const buyDown = parseFloat(document.getElementById('buy-down').value);
            const buyRate = parseFloat(document.getElementById('buy-rate').value) / 100 / 12;
            const buyTerm = parseInt(document.getElementById('buy-term').value);

            const leaseDown = parseFloat(document.getElementById('lease-down').value);
            const leasePayment = parseFloat(document.getElementById('lease-payment').value);
            const leaseTerm = parseInt(document.getElementById('lease-term').value);
            const depreciation = parseFloat(document.getElementById('car-depreciation').value) / 100;

            // Buying calculation
            const buyPrincipal = carPrice - buyDown;
            const buyMonthly = buyPrincipal * (buyRate * Math.pow(1 + buyRate, buyTerm)) / (Math.pow(1 + buyRate, buyTerm) - 1);
            const buyTotalPaid = (buyMonthly * buyTerm) + buyDown;
            const buyInterest = (buyMonthly * buyTerm) - buyPrincipal;

            // Calculate equity at lease term end
            let buyBalance = buyPrincipal;
            for (let i = 0; i < leaseTerm; i++) {
                const interest = buyBalance * buyRate;
                const principal = buyMonthly - interest;
                buyBalance -= principal;
            }
            const buyEquity = carPrice - buyBalance;
            const buyPaidAtLeaseTerm = (buyMonthly * leaseTerm) + buyDown;

            // Car value after depreciation
            const yearsDepreciation = leaseTerm / 12;
            const carValueAtLeaseTerm = carPrice * Math.pow(1 - depreciation, yearsDepreciation);

            // Leasing calculation
            const leaseTotalPaid = (leasePayment * leaseTerm) + leaseDown;

            // Net worth comparison
            const buyNetWorth = carValueAtLeaseTerm - buyBalance;
            const leaseNetWorth = -leaseTotalPaid;
            const difference = buyNetWorth - leaseNetWorth;

            const resultsDiv = document.getElementById('carlease-results');
            resultsDiv.innerHTML = `
                <div class="results">
                    <h3>After ${leaseTerm} months (${(leaseTerm/12).toFixed(1)} years)</h3>
                    <div class="comparison-grid">
                        <div class="comparison-card" style="border: 2px solid #10b981;">
                            <h4>üí∞ Buying</h4>
                            <div class="result-item">
                                <span class="result-label">Monthly Payment</span>
                                <span class="result-value">$${buyMonthly.toFixed(2)}</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Total Paid</span>
                                <span class="result-value">$${buyPaidAtLeaseTerm.toFixed(2)}</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Amount Owed</span>
                                <span class="result-value">$${buyBalance.toFixed(2)}</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Car Value</span>
                                <span class="result-value">$${carValueAtLeaseTerm.toFixed(2)}</span>
                            </div>
                            <div class="result-item" style="border-top: 2px solid #10b981; margin-top: 10px; padding-top: 10px;">
                                <span class="result-label"><strong>Net Worth Impact</strong></span>
                                <span class="result-value" style="color: #10b981;">+$${buyNetWorth.toFixed(2)}</span>
                            </div>
                        </div>
                        <div class="comparison-card" style="border: 2px solid #ef4444;">
                            <h4>üîÑ Leasing</h4>
                            <div class="result-item">
                                <span class="result-label">Monthly Payment</span>
                                <span class="result-value">$${leasePayment.toFixed(2)}</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Total Paid</span>
                                <span class="result-value">$${leaseTotalPaid.toFixed(2)}</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Amount Owed</span>
                                <span class="result-value">$0</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Car Value</span>
                                <span class="result-value">$0 (you own nothing)</span>
                            </div>
                            <div class="result-item" style="border-top: 2px solid #ef4444; margin-top: 10px; padding-top: 10px;">
                                <span class="result-label"><strong>Net Worth Impact</strong></span>
                                <span class="result-value" style="color: #ef4444;">-$${leaseTotalPaid.toFixed(2)}</span>
                            </div>
                        </div>
                    </div>
                    <div class="success">
                        <p><strong>Buying wins by $${difference.toFixed(2)}</strong><br>
                        Lower monthly payment when leasing ($${(buyMonthly - leasePayment).toFixed(2)} less), but you're building $${buyNetWorth.toFixed(2)} in equity vs nothing.</p>
                    </div>
                    <div class="info-box">
                        <p><strong>Long-term perspective:</strong> After ${buyTerm} months, you'd own a car worth ~$${(carPrice * Math.pow(1 - depreciation, buyTerm/12)).toFixed(2)}. 
                        If you kept leasing, you'd have paid $${((leasePayment * (buyTerm / leaseTerm) * leaseTerm) + (leaseDown * (buyTerm / leaseTerm))).toFixed(2)} and own nothing.</p>
                    </div>
                </div>
            `;
        }

        // Rent vs Buy Calculator
        function calculateRentBuy() {
            const monthlyRent = parseFloat(document.getElementById('monthly-rent').value);
            const rentIncrease = parseFloat(document.getElementById('rent-increase').value) / 100;
            const rentersInsurance = parseFloat(document.getElementById('renters-insurance').value);

            const homePrice = parseFloat(document.getElementById('home-price').value);
            const homeDown = parseFloat(document.getElementById('home-down').value);
            const homeRate = parseFloat(document.getElementById('home-rate').value) / 100 / 12;
            const homeYears = parseInt(document.getElementById('home-term').value);
            const homeTerm = homeYears * 12;

            const state = document.getElementById('home-state').value;
            const stateTax = stateTaxRates[state] || 1;
            const localTax = parseFloat(document.getElementById('home-local-tax').value);
            const totalTaxRate = (stateTax + localTax) / 100;

            const homeHOA = parseFloat(document.getElementById('home-hoa').value);
            const homeInsurance = parseFloat(document.getElementById('home-insurance').value);
            const maintenanceRate = parseFloat(document.getElementById('home-maintenance').value) / 100;
            const appreciation = parseFloat(document.getElementById('home-appreciation').value) / 100;
            const comparisonYears = parseInt(document.getElementById('comparison-years').value);

            // Mortgage calculation
            const principal = homePrice - homeDown;
            const monthlyPI = principal * (homeRate * Math.pow(1 + homeRate, homeTerm)) / (Math.pow(1 + homeRate, homeTerm) - 1);
            const monthlyTax = (homePrice * totalTaxRate) / 12;
            const monthlyInsurance = homeInsurance / 12;
            const monthlyMaintenance = (homePrice * maintenanceRate) / 12;
            const totalMonthlyOwn = monthlyPI + monthlyTax + monthlyInsurance + homeHOA + monthlyMaintenance;

            // Year-by-year comparison
            let totalRentPaid = 0;
            let totalOwnPaid = homeDown; // Include down payment
            let currentRent = monthlyRent;
            let mortgageBalance = principal;
            let homeValue = homePrice;

            for (let year = 0; year < comparisonYears; year++) {
                // Rent increases each year
                totalRentPaid += (currentRent + rentersInsurance) * 12;
                currentRent *= (1 + rentIncrease);

                // Ownership costs
                totalOwnPaid += totalMonthlyOwn * 12;

                // Calculate mortgage balance
                for (let month = 0; month < 12; month++) {
                    if (mortgageBalance > 0) {
                        const interest = mortgageBalance * homeRate;
                        const principalPaid = monthlyPI - interest;
                        mortgageBalance -= principalPaid;
                        if (mortgageBalance < 0) mortgageBalance = 0;
                    }
                }

                // Home appreciation
                homeValue *= (1 + appreciation);
            }

            const equity = homeValue - mortgageBalance;
            const rentNetWorth = -totalRentPaid;
            const ownNetWorth = equity - totalOwnPaid;
            const difference = ownNetWorth - rentNetWorth;

            // Break-even calculation
            let breakEvenYear = 0;
            let rentCost = 0;
            let ownCost = homeDown;
            let tempRent = monthlyRent;
            let tempBalance = principal;
            let tempValue = homePrice;

            for (let year = 1; year <= 30; year++) {
                rentCost += (tempRent + rentersInsurance) * 12;
                tempRent *= (1 + rentIncrease);

                ownCost += totalMonthlyOwn * 12;

                for (let month = 0; month < 12; month++) {
                    if (tempBalance > 0) {
                        const interest = tempBalance * homeRate;
                        const principalPaid = monthlyPI - interest;
                        tempBalance -= principalPaid;
                        if (tempBalance < 0) tempBalance = 0;
                    }
                }

                tempValue *= (1 + appreciation);
                const tempEquity = tempValue - tempBalance;

                if (tempEquity > ownCost && breakEvenYear === 0) {
                    breakEvenYear = year;
                }
            }

            const resultsDiv = document.getElementById('rentbuy-results');
            resultsDiv.innerHTML = `
                <div class="results">
                    <h3>Monthly Cost Comparison</h3>
                    <div class="comparison-grid">
                        <div class="comparison-card">
                            <h4>üè¢ Renting</h4>
                            <div class="result-item">
                                <span class="result-label">Rent</span>
                                <span class="result-value">$${monthlyRent.toFixed(2)}</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Insurance</span>
                                <span class="result-value">$${rentersInsurance.toFixed(2)}</span>
                            </div>
                            <div class="result-item" style="border-top: 2px solid #6b7280; margin-top: 10px; padding-top: 10px;">
                                <span class="result-label"><strong>Total</strong></span>
                                <span class="result-value">$${(monthlyRent + rentersInsurance).toFixed(2)}</span>
                            </div>
                        </div>
                        <div class="comparison-card">
                            <h4>üè† Buying</h4>
                            <div class="result-item">
                                <span class="result-label">Mortgage (P&I)</span>
                                <span class="result-value">$${monthlyPI.toFixed(2)}</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Property Tax</span>
                                <span class="result-value">$${monthlyTax.toFixed(2)}</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Insurance</span>
                                <span class="result-value">$${monthlyInsurance.toFixed(2)}</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">HOA</span>
                                <span class="result-value">$${homeHOA.toFixed(2)}</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Maintenance</span>
                                <span class="result-value">$${monthlyMaintenance.toFixed(2)}</span>
                            </div>
                            <div class="result-item" style="border-top: 2px solid #6b7280; margin-top: 10px; padding-top: 10px;">
                                <span class="result-label"><strong>Total</strong></span>
                                <span class="result-value">$${totalMonthlyOwn.toFixed(2)}</span>
                            </div>
                        </div>
                    </div>
                    <div class="warning">
                        <p>Owning costs $${(totalMonthlyOwn - (monthlyRent + rentersInsurance)).toFixed(2)} more per month initially, but you're building equity.</p>
                    </div>

                    <h3 style="margin-top: 30px;">After ${comparisonYears} Years</h3>
                    <div class="comparison-grid">
                        <div class="comparison-card">
                            <h4>üè¢ Renting</h4>
                            <div class="result-item">
                                <span class="result-label">Total Paid</span>
                                <span class="result-value">$${totalRentPaid.toFixed(2)}</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Equity Built</span>
                                <span class="result-value">$0</span>
                            </div>
                            <div class="result-item" style="border-top: 2px solid #ef4444; margin-top: 10px; padding-top: 10px;">
                                <span class="result-label"><strong>Net Worth</strong></span>
                                <span class="result-value" style="color: #ef4444;">-$${totalRentPaid.toFixed(2)}</span>
                            </div>
                        </div>
                        <div class="comparison-card">
                            <h4>üè† Buying</h4>
                            <div class="result-item">
                                <span class="result-label">Total Paid</span>
                                <span class="result-value">$${totalOwnPaid.toFixed(2)}</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Home Value</span>
                                <span class="result-value">$${homeValue.toFixed(2)}</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Remaining Mortgage</span>
                                <span class="result-value">$${mortgageBalance.toFixed(2)}</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">Equity</span>
                                <span class="result-value">$${equity.toFixed(2)}</span>
                            </div>
                            <div class="result-item" style="border-top: 2px solid #10b981; margin-top: 10px; padding-top: 10px;">
                                <span class="result-label"><strong>Net Worth</strong></span>
                                <span class="result-value" style="color: #10b981;">${ownNetWorth >= 0 ? '+' : ''}$${ownNetWorth.toFixed(2)}</span>
                            </div>
                        </div>
                    </div>
                    ${difference > 0 ? 
                        `<div class="success">
                            <p><strong>Buying wins by $${difference.toFixed(2)}</strong><br>
                            ${breakEvenYear > 0 ? `You break even after ${breakEvenYear} years. ` : ''}
                            After ${comparisonYears} years, owning puts you ahead by building equity while home values appreciate.</p>
                        </div>` :
                        `<div class="warning">
                            <p><strong>Renting is cheaper by $${Math.abs(difference).toFixed(2)} over ${comparisonYears} years</strong><br>
                            If you plan to move before ${breakEvenYear} years, renting may be the better choice. Consider your timeline and goals.</p>
                        </div>`
                    }
                    <div class="info-box">
                        <p><strong>Hidden costs of buying:</strong> This calculation includes down payment ($${homeDown.toFixed(2)}), but doesn't include closing costs (~$${(homePrice * 0.03).toFixed(2)}), moving costs, or furniture. Factor these into your decision.</p>
                    </div>
                </div>
            `;
        }

        // Side Hustle Calculator
        function calculateSideHustle() {
            const income = parseFloat(document.getElementById('hustle-income').value);
            const hours = parseFloat(document.getElementById('hustle-hours').value);
            const gas = parseFloat(document.getElementById('hustle-gas').value);
            const supplies = parseFloat(document.getElementById('hustle-supplies').value);
            const software = parseFloat(document.getElementById('hustle-software').value);
            const other = parseFloat(document.getElementById('hustle-other').value);
            const taxRate = parseFloat(document.getElementById('hustle-tax').value) / 100;
            const dayJobRate = parseFloat(document.getElementById('hustle-dayjob').value);

            const totalExpenses = gas + supplies + software + other;
            const netBeforeTax = income - totalExpenses;
            const taxes = netBeforeTax * taxRate;
            const netAfterTax = netBeforeTax - taxes;
            const hourlyRate = netAfterTax / hours;

            const annualGross = income * 12;
            const annualExpenses = totalExpenses * 12;
            const annualTaxes = taxes * 12;
            const annualNet = netAfterTax * 12;

            const difference = hourlyRate - dayJobRate;
            const percentDiff = (difference / dayJobRate) * 100;

            const resultsDiv = document.getElementById('sidehustle-results');
            resultsDiv.innerHTML = `
                <div class="results">
                    <h3>Monthly Breakdown</h3>
                    <div class="result-item">
                        <span class="result-label">Gross Income</span>
                        <span class="result-value">$${income.toFixed(2)}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Total Expenses</span>
                        <span class="result-value">-$${totalExpenses.toFixed(2)}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Estimated Taxes (${(taxRate * 100).toFixed(0)}%)</span>
                        <span class="result-value">-$${taxes.toFixed(2)}</span>
                    </div>
                    <div class="result-item" style="border-top: 2px solid #10b981; margin-top: 10px; padding-top: 15px;">
                        <span class="result-label"><strong>Net Income</strong></span>
                        <span class="result-value" style="font-size: 1.3rem;">$${netAfterTax.toFixed(2)}</span>
                    </div>

                    <h3 style="margin-top: 30px;">Hourly Rate Analysis</h3>
                    <div class="result-item">
                        <span class="result-label">Hours Worked</span>
                        <span class="result-value">${hours} hours</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">True Hourly Rate</span>
                        <span class="result-value">$${hourlyRate.toFixed(2)}/hour</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Day Job Rate</span>
                        <span class="result-value">$${dayJobRate.toFixed(2)}/hour</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Difference</span>
                        <span class="result-value" style="color: ${difference >= 0 ? '#10b981' : '#ef4444'};">
                            ${difference >= 0 ? '+' : ''}$${difference.toFixed(2)}/hour (${difference >= 0 ? '+' : ''}${percentDiff.toFixed(1)}%)
                        </span>
                    </div>

                    ${difference >= 0 ? 
                        `<div class="success">
                            <p><strong>Your side hustle pays better!</strong><br>
                            You're earning $${difference.toFixed(2)} more per hour than your day job. 
                            That's an extra $${(difference * hours).toFixed(2)} per month for the same time invested.</p>
                        </div>` :
                        `<div class="warning">
                            <p><strong>Your day job pays better per hour</strong><br>
                            You're earning $${Math.abs(difference).toFixed(2)} less per hour with your side hustle. 
                            Consider if the flexibility or other benefits make up for the lower rate, or look for ways to increase efficiency.</p>
                        </div>`
                    }

                    <h3 style="margin-top: 30px;">Annual Projection</h3>
                    <div class="result-item">
                        <span class="result-label">Annual Gross Income</span>
                        <span class="result-value">$${annualGross.toFixed(2)}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Annual Expenses</span>
                        <span class="result-value">$${annualExpenses.toFixed(2)}</span>
                    </div>
                    <div class="result-item">
                        <span class="result-label">Annual Taxes</span>
                        <span class="result-value">$${annualTaxes.toFixed(2)}</span>
                    </div>
                    <div class="result-item" style="border-top: 2px solid #10b981; margin-top: 10px; padding-top: 15px;">
                        <span class="result-label"><strong>Annual Net Income</strong></span>
                        <span class="result-value" style="font-size: 1.3rem;">$${annualNet.toFixed(2)}</span>
                    </div>

                    <div class="info-box">
                        <p><strong>Expense Breakdown:</strong><br>
                        Gas/Transportation: $${gas.toFixed(2)}/mo ($${(gas * 12).toFixed(2)}/year)<br>
                        Supplies/Materials: $${supplies.toFixed(2)}/mo ($${(supplies * 12).toFixed(2)}/year)<br>
                        Software/Subscriptions: $${software.toFixed(2)}/mo ($${(software * 12).toFixed(2)}/year)<br>
                        Other: $${other.toFixed(2)}/mo ($${(other * 12).toFixed(2)}/year)</p>
                    </div>
                </div>
            `;
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            initializeYearDropdowns();
            initializeSubscriptions();
        });
    </script>
</body>
</html>