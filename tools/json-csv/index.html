<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>JSON â†” CSV Converter | Free Online Tool</title>
  <meta name="description" content="Convert JSON to CSV and CSV to JSON instantly. Handles nested objects, arrays, and large files. Free, private, no upload required.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    :root {
      --bg-primary: #0f172a;
      --bg-secondary: #1e293b;
      --bg-card: #334155;
      --bg-input: #0f172a;
      --accent: #3b82f6;
      --accent-hover: #2563eb;
      --accent-glow: rgba(59, 130, 246, 0.3);
      --success: #10b981;
      --success-glow: rgba(16, 185, 129, 0.3);
      --warning: #f59e0b;
      --danger: #ef4444;
      --text-primary: #f1f5f9;
      --text-secondary: #94a3b8;
      --text-muted: #64748b;
      --border: #475569;
      --radius: 12px;
      --radius-sm: 8px;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.6;
      min-height: 100vh;
    }

    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: 
        radial-gradient(ellipse at 20% 20%, rgba(59, 130, 246, 0.08) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 80%, rgba(16, 185, 129, 0.06) 0%, transparent 50%);
      pointer-events: none;
      z-index: 0;
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 2rem 1.5rem;
      position: relative;
      z-index: 1;
    }

    /* Header */
    header {
      text-align: center;
      margin-bottom: 2rem;
    }

    .logo {
      display: inline-flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 0.5rem;
    }

    .logo-icon {
      width: 48px;
      height: 48px;
      background: linear-gradient(135deg, var(--accent) 0%, var(--success) 100%);
      border-radius: var(--radius);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.25rem;
      box-shadow: 0 4px 20px var(--accent-glow);
    }

    header h1 {
      font-size: 2rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--text-primary) 0%, var(--accent) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .tagline {
      color: var(--text-secondary);
      font-size: 1rem;
      margin-top: 0.25rem;
    }

    .trust-badges {
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      margin-top: 1rem;
      flex-wrap: wrap;
    }

    .trust-badge {
      display: flex;
      align-items: center;
      gap: 0.4rem;
      color: var(--text-muted);
      font-size: 0.8rem;
    }

    .trust-badge span {
      color: var(--accent);
    }

    /* Tab Navigation */
    .tab-nav {
      display: flex;
      justify-content: center;
      gap: 0.5rem;
      margin-bottom: 1.5rem;
      background: var(--bg-secondary);
      padding: 0.375rem;
      border-radius: var(--radius);
      width: fit-content;
      margin-left: auto;
      margin-right: auto;
    }

    .tab-btn {
      padding: 0.75rem 1.5rem;
      border: none;
      background: transparent;
      color: var(--text-secondary);
      font-size: 0.95rem;
      font-weight: 500;
      cursor: pointer;
      border-radius: var(--radius-sm);
      transition: all 0.2s;
      font-family: inherit;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .tab-btn:hover {
      color: var(--text-primary);
      background: var(--bg-card);
    }

    .tab-btn.active {
      background: var(--accent);
      color: white;
    }

    .tab-btn svg {
      width: 18px;
      height: 18px;
    }

    /* Main Layout */
    .converter-layout {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 1.5rem;
    }

    @media (max-width: 900px) {
      .converter-layout {
        grid-template-columns: 1fr;
      }
    }

    /* Panels */
    .panel {
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      display: flex;
      flex-direction: column;
      min-height: 500px;
    }

    .panel-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 1rem 1.25rem;
      border-bottom: 1px solid var(--border);
      flex-wrap: wrap;
      gap: 0.75rem;
    }

    .panel-title {
      font-weight: 600;
      font-size: 1rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .panel-title .format-tag {
      font-size: 0.7rem;
      font-weight: 600;
      padding: 0.2rem 0.5rem;
      border-radius: 4px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .format-tag.json {
      background: rgba(251, 191, 36, 0.2);
      color: #fbbf24;
    }

    .format-tag.csv {
      background: rgba(16, 185, 129, 0.2);
      color: var(--success);
    }

    .panel-actions {
      display: flex;
      gap: 0.5rem;
      align-items: center;
    }

    .panel-body {
      flex: 1;
      display: flex;
      flex-direction: column;
      padding: 1rem;
      gap: 1rem;
    }

    /* Textarea */
    .input-wrapper {
      flex: 1;
      display: flex;
      flex-direction: column;
      position: relative;
    }

    textarea {
      flex: 1;
      width: 100%;
      min-height: 300px;
      padding: 1rem;
      background: var(--bg-input);
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
      color: var(--text-primary);
      font-family: 'JetBrains Mono', monospace;
      font-size: 0.85rem;
      line-height: 1.6;
      resize: vertical;
      transition: all 0.2s;
    }

    textarea:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--accent-glow);
    }

    textarea::placeholder {
      color: var(--text-muted);
    }

    /* Drop Zone */
    .drop-zone {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(59, 130, 246, 0.1);
      border: 2px dashed var(--accent);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s;
      z-index: 10;
    }

    .drop-zone.active {
      opacity: 1;
    }

    .drop-zone-text {
      font-size: 1.1rem;
      color: var(--accent);
      font-weight: 500;
    }

    /* Buttons */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 0.4rem;
      padding: 0.5rem 1rem;
      border: none;
      border-radius: 6px;
      font-size: 0.85rem;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      font-family: inherit;
      white-space: nowrap;
    }

    .btn svg {
      width: 16px;
      height: 16px;
    }

    .btn-primary {
      background: var(--accent);
      color: white;
    }

    .btn-primary:hover {
      background: var(--accent-hover);
      transform: translateY(-1px);
    }

    .btn-secondary {
      background: var(--bg-card);
      color: var(--text-primary);
      border: 1px solid var(--border);
    }

    .btn-secondary:hover {
      background: var(--bg-input);
      border-color: var(--accent);
    }

    .btn-success {
      background: var(--success);
      color: white;
    }

    .btn-success:hover {
      background: #059669;
    }

    .btn-icon {
      padding: 0.5rem;
      background: var(--bg-card);
      color: var(--text-secondary);
      border: 1px solid var(--border);
    }

    .btn-icon:hover {
      color: var(--text-primary);
      border-color: var(--accent);
    }

    /* Options Panel */
    .options-bar {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      padding: 0.75rem 1rem;
      background: var(--bg-card);
      border-radius: var(--radius-sm);
      align-items: center;
    }

    .option-group {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .option-group label {
      font-size: 0.8rem;
      color: var(--text-secondary);
    }

    .option-group select {
      padding: 0.4rem 0.75rem;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 4px;
      color: var(--text-primary);
      font-size: 0.8rem;
      font-family: inherit;
      cursor: pointer;
    }

    .option-group select:focus {
      outline: none;
      border-color: var(--accent);
    }

    .checkbox-label {
      display: flex;
      align-items: center;
      gap: 0.4rem;
      font-size: 0.8rem;
      color: var(--text-secondary);
      cursor: pointer;
    }

    .checkbox-label input {
      width: 16px;
      height: 16px;
      accent-color: var(--accent);
      cursor: pointer;
    }

    /* Convert Button */
    .convert-section {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 1rem;
    }

    .convert-btn {
      padding: 0.875rem 2rem;
      font-size: 1rem;
      font-weight: 600;
      border-radius: var(--radius-sm);
      background: linear-gradient(135deg, var(--accent) 0%, var(--accent-hover) 100%);
      color: white;
      border: none;
      cursor: pointer;
      transition: all 0.2s;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .convert-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 10px 30px var(--accent-glow);
    }

    .convert-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .convert-btn svg {
      width: 20px;
      height: 20px;
    }

    /* Preview Table */
    .preview-container {
      margin-top: 1rem;
      overflow: hidden;
      border: 1px solid var(--border);
      border-radius: var(--radius-sm);
    }

    .preview-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.75rem 1rem;
      background: var(--bg-card);
      border-bottom: 1px solid var(--border);
    }

    .preview-title {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text-secondary);
    }

    .preview-stats {
      font-size: 0.75rem;
      color: var(--text-muted);
    }

    .preview-table-wrapper {
      overflow: auto;
      max-height: 300px;
    }

    .preview-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.8rem;
    }

    .preview-table th,
    .preview-table td {
      padding: 0.5rem 0.75rem;
      text-align: left;
      border-bottom: 1px solid var(--border);
      white-space: nowrap;
      max-width: 200px;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .preview-table th {
      background: var(--bg-secondary);
      font-weight: 600;
      color: var(--text-secondary);
      position: sticky;
      top: 0;
      z-index: 1;
    }

    .preview-table tr:hover td {
      background: var(--bg-card);
    }

    .preview-table td {
      font-family: 'JetBrains Mono', monospace;
      color: var(--text-primary);
    }

    /* Status Messages */
    .status {
      padding: 0.75rem 1rem;
      border-radius: var(--radius-sm);
      font-size: 0.85rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .status-success {
      background: rgba(16, 185, 129, 0.1);
      border: 1px solid rgba(16, 185, 129, 0.3);
      color: var(--success);
    }

    .status-error {
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
      color: var(--danger);
    }

    .status-warning {
      background: rgba(245, 158, 11, 0.1);
      border: 1px solid rgba(245, 158, 11, 0.3);
      color: var(--warning);
    }

    .status-info {
      background: rgba(59, 130, 246, 0.1);
      border: 1px solid rgba(59, 130, 246, 0.3);
      color: var(--accent);
    }

    /* Footer */
    footer {
      text-align: center;
      padding: 2rem 0;
      margin-top: 2rem;
      border-top: 1px solid var(--border);
      color: var(--text-muted);
      font-size: 0.85rem;
    }

    footer a {
      color: var(--accent);
      text-decoration: none;
    }

    footer a:hover {
      text-decoration: underline;
    }

    /* Responsive */
    @media (max-width: 600px) {
      .container {
        padding: 1rem;
      }

      header h1 {
        font-size: 1.5rem;
      }

      .tab-btn {
        padding: 0.6rem 1rem;
        font-size: 0.85rem;
      }

      .panel-header {
        flex-direction: column;
        align-items: flex-start;
      }

      .options-bar {
        flex-direction: column;
        align-items: flex-start;
      }
    }

    /* Scrollbar */
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: var(--bg-primary); }
    ::-webkit-scrollbar-thumb { background: var(--bg-card); border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--border); }

    /* Hidden */
    .hidden { display: none !important; }

    /* File Input */
    .file-input {
      display: none;
    }

    /* Sample data link */
    .sample-link {
      font-size: 0.8rem;
      color: var(--text-muted);
      cursor: pointer;
      text-decoration: underline;
      text-decoration-style: dashed;
      text-underline-offset: 2px;
    }

    .sample-link:hover {
      color: var(--accent);
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="logo">
        <div class="logo-icon">â‡„</div>
        <h1>JSON â†” CSV Converter</h1>
      </div>
      <p class="tagline">Convert between JSON and CSV instantly. Handles nested objects and arrays.</p>
      <div class="trust-badges">
        <div class="trust-badge"><span>ðŸ”’</span> 100% Private</div>
        <div class="trust-badge"><span>ðŸ’»</span> Runs Locally</div>
        <div class="trust-badge"><span>âš¡</span> No File Size Limit</div>
      </div>
    </header>

    <!-- Tab Navigation -->
    <nav class="tab-nav">
      <button class="tab-btn active" data-tab="json-to-csv">
        <span>{ }</span> JSON â†’ CSV
      </button>
      <button class="tab-btn" data-tab="csv-to-json">
        <span>ðŸ“„</span> CSV â†’ JSON
      </button>
    </nav>

    <!-- JSON to CSV Tab -->
    <div id="json-to-csv" class="tab-content">
      <div class="converter-layout">
        <!-- Input Panel -->
        <div class="panel">
          <div class="panel-header">
            <div class="panel-title">
              Input
              <span class="format-tag json">JSON</span>
            </div>
            <div class="panel-actions">
              <span class="sample-link" onclick="loadSampleJSON()">Load sample</span>
              <button class="btn btn-icon" onclick="document.getElementById('jsonFileInput').click()" title="Upload file">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
                </svg>
              </button>
              <input type="file" id="jsonFileInput" class="file-input" accept=".json,application/json" onchange="handleJSONFileUpload(event)">
              <button class="btn btn-icon" onclick="clearInput('jsonInput')" title="Clear">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                </svg>
              </button>
            </div>
          </div>
          <div class="panel-body">
            <div class="input-wrapper">
              <textarea id="jsonInput" placeholder='Paste your JSON here...

Example:
[
  {"name": "Alice", "age": 30, "city": "NYC"},
  {"name": "Bob", "age": 25, "city": "LA"}
]'></textarea>
              <div class="drop-zone" id="jsonDropZone">
                <span class="drop-zone-text">Drop JSON file here</span>
              </div>
            </div>
            <div class="options-bar">
              <div class="option-group">
                <label for="delimiter">Delimiter:</label>
                <select id="delimiter">
                  <option value=",">Comma (,)</option>
                  <option value="&#9;">Tab</option>
                  <option value=";">Semicolon (;)</option>
                  <option value="|">Pipe (|)</option>
                </select>
              </div>
              <label class="checkbox-label">
                <input type="checkbox" id="flattenNested" checked>
                Flatten nested objects
              </label>
              <label class="checkbox-label">
                <input type="checkbox" id="includeHeaders" checked>
                Include headers
              </label>
            </div>
          </div>
        </div>

        <!-- Output Panel -->
        <div class="panel">
          <div class="panel-header">
            <div class="panel-title">
              Output
              <span class="format-tag csv">CSV</span>
            </div>
            <div class="panel-actions">
              <button class="btn btn-secondary" onclick="copyToClipboard('csvOutput')">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                </svg>
                Copy
              </button>
              <button class="btn btn-success" onclick="downloadCSV()">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                </svg>
                Download
              </button>
            </div>
          </div>
          <div class="panel-body">
            <div class="input-wrapper">
              <textarea id="csvOutput" readonly placeholder="CSV output will appear here..."></textarea>
            </div>
            <div id="jsonToCsvStatus"></div>
          </div>
        </div>
      </div>

      <div class="convert-section">
        <button class="convert-btn" onclick="convertJSONtoCSV()">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M13 7l5 5m0 0l-5 5m5-5H6" />
          </svg>
          Convert to CSV
        </button>
      </div>

      <!-- Preview Table -->
      <div id="csvPreview" class="preview-container hidden">
        <div class="preview-header">
          <span class="preview-title">Preview</span>
          <span class="preview-stats" id="csvPreviewStats"></span>
        </div>
        <div class="preview-table-wrapper">
          <table class="preview-table" id="csvPreviewTable"></table>
        </div>
      </div>
    </div>

    <!-- CSV to JSON Tab -->
    <div id="csv-to-json" class="tab-content hidden">
      <div class="converter-layout">
        <!-- Input Panel -->
        <div class="panel">
          <div class="panel-header">
            <div class="panel-title">
              Input
              <span class="format-tag csv">CSV</span>
            </div>
            <div class="panel-actions">
              <span class="sample-link" onclick="loadSampleCSV()">Load sample</span>
              <button class="btn btn-icon" onclick="document.getElementById('csvFileInput').click()" title="Upload file">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-8l-4-4m0 0L8 8m4-4v12" />
                </svg>
              </button>
              <input type="file" id="csvFileInput" class="file-input" accept=".csv,.tsv,.txt,text/csv" onchange="handleCSVFileUpload(event)">
              <button class="btn btn-icon" onclick="clearInput('csvInput')" title="Clear">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                </svg>
              </button>
            </div>
          </div>
          <div class="panel-body">
            <div class="input-wrapper">
              <textarea id="csvInput" placeholder='Paste your CSV here...

Example:
name,age,city
Alice,30,NYC
Bob,25,LA'></textarea>
              <div class="drop-zone" id="csvDropZone">
                <span class="drop-zone-text">Drop CSV file here</span>
              </div>
            </div>
            <div class="options-bar">
              <div class="option-group">
                <label for="csvDelimiter">Delimiter:</label>
                <select id="csvDelimiter">
                  <option value="auto">Auto-detect</option>
                  <option value=",">Comma (,)</option>
                  <option value="&#9;">Tab</option>
                  <option value=";">Semicolon (;)</option>
                  <option value="|">Pipe (|)</option>
                </select>
              </div>
              <label class="checkbox-label">
                <input type="checkbox" id="firstRowHeaders" checked>
                First row is headers
              </label>
              <label class="checkbox-label">
                <input type="checkbox" id="inferTypes" checked>
                Infer types (numbers, booleans)
              </label>
            </div>
          </div>
        </div>

        <!-- Output Panel -->
        <div class="panel">
          <div class="panel-header">
            <div class="panel-title">
              Output
              <span class="format-tag json">JSON</span>
            </div>
            <div class="panel-actions">
              <button class="btn btn-secondary" onclick="copyToClipboard('jsonOutput')">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                </svg>
                Copy
              </button>
              <button class="btn btn-success" onclick="downloadJSON()">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                </svg>
                Download
              </button>
            </div>
          </div>
          <div class="panel-body">
            <div class="input-wrapper">
              <textarea id="jsonOutput" readonly placeholder="JSON output will appear here..."></textarea>
            </div>
            <div id="csvToJsonStatus"></div>
          </div>
        </div>
      </div>

      <div class="convert-section">
        <button class="convert-btn" onclick="convertCSVtoJSON()">
          <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
            <path stroke-linecap="round" stroke-linejoin="round" d="M13 7l5 5m0 0l-5 5m5-5H6" />
          </svg>
          Convert to JSON
        </button>
      </div>

      <div id="csvToJsonStatus"></div>
    </div>

    <footer>
      <p>Built by <a href="https://mattlivingston.com">Matt Livingston</a> â€¢ All processing happens locally in your browser</p>
    </footer>
  </div>

  <script>
    // ============================================
    // Tab Navigation
    // ============================================
    document.querySelectorAll('.tab-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        document.querySelectorAll('.tab-content').forEach(c => c.classList.add('hidden'));
        document.getElementById(btn.dataset.tab).classList.remove('hidden');
      });
    });

    // ============================================
    // Drag & Drop
    // ============================================
    function setupDropZone(dropZoneId, textareaId, fileType) {
      const dropZone = document.getElementById(dropZoneId);
      const textarea = document.getElementById(textareaId);
      const wrapper = textarea.parentElement;

      ['dragenter', 'dragover'].forEach(event => {
        wrapper.addEventListener(event, (e) => {
          e.preventDefault();
          dropZone.classList.add('active');
        });
      });

      ['dragleave', 'drop'].forEach(event => {
        wrapper.addEventListener(event, (e) => {
          e.preventDefault();
          dropZone.classList.remove('active');
        });
      });

      wrapper.addEventListener('drop', (e) => {
        const file = e.dataTransfer.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = (event) => {
            textarea.value = event.target.result;
          };
          reader.readAsText(file);
        }
      });
    }

    setupDropZone('jsonDropZone', 'jsonInput', 'json');
    setupDropZone('csvDropZone', 'csvInput', 'csv');

    // ============================================
    // File Upload Handlers
    // ============================================
    function handleJSONFileUpload(event) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = (e) => {
          document.getElementById('jsonInput').value = e.target.result;
        };
        reader.readAsText(file);
      }
    }

    function handleCSVFileUpload(event) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = (e) => {
          document.getElementById('csvInput').value = e.target.result;
        };
        reader.readAsText(file);
      }
    }

    // ============================================
    // Sample Data
    // ============================================
    function loadSampleJSON() {
      const sample = [
        {
          "id": 1,
          "name": "Alice Johnson",
          "email": "alice@example.com",
          "age": 32,
          "active": true,
          "address": {
            "street": "123 Main St",
            "city": "New York",
            "zip": "10001"
          },
          "tags": ["developer", "manager"],
          "metadata": {
            "created": "2024-01-15",
            "lastLogin": "2024-12-28"
          }
        },
        {
          "id": 2,
          "name": "Bob Smith",
          "email": "bob@example.com",
          "age": 28,
          "active": true,
          "address": {
            "street": "456 Oak Ave",
            "city": "Los Angeles",
            "zip": "90001"
          },
          "tags": ["designer"],
          "metadata": {
            "created": "2024-03-20",
            "lastLogin": "2024-12-27"
          }
        },
        {
          "id": 3,
          "name": "Carol Davis",
          "email": "carol@example.com",
          "age": 45,
          "active": false,
          "address": {
            "street": "789 Pine Rd",
            "city": "Chicago",
            "zip": "60601"
          },
          "tags": ["admin", "developer", "lead"],
          "metadata": {
            "created": "2023-06-10",
            "lastLogin": "2024-11-15"
          }
        }
      ];
      document.getElementById('jsonInput').value = JSON.stringify(sample, null, 2);
    }

    function loadSampleCSV() {
      const sample = `name,age,city,email,department,salary
Alice Johnson,32,New York,alice@example.com,Engineering,95000
Bob Smith,28,Los Angeles,bob@example.com,Design,78000
Carol Davis,45,Chicago,carol@example.com,Management,120000
David Wilson,35,Houston,david@example.com,Engineering,88000
Eva Martinez,29,Phoenix,eva@example.com,Marketing,72000`;
      document.getElementById('csvInput').value = sample;
    }

    // ============================================
    // Utility Functions
    // ============================================
    function clearInput(textareaId) {
      document.getElementById(textareaId).value = '';
      if (textareaId === 'jsonInput') {
        document.getElementById('csvOutput').value = '';
        document.getElementById('csvPreview').classList.add('hidden');
        document.getElementById('jsonToCsvStatus').innerHTML = '';
      } else if (textareaId === 'csvInput') {
        document.getElementById('jsonOutput').value = '';
        document.getElementById('csvToJsonStatus').innerHTML = '';
      }
    }

    function copyToClipboard(textareaId) {
      const textarea = document.getElementById(textareaId);
      if (!textarea.value) return;
      
      navigator.clipboard.writeText(textarea.value).then(() => {
        showToast('Copied to clipboard!');
      });
    }

    function showToast(message) {
      const existing = document.querySelector('.toast');
      if (existing) existing.remove();

      const toast = document.createElement('div');
      toast.className = 'toast';
      toast.textContent = message;
      toast.style.cssText = `
        position: fixed;
        bottom: 2rem;
        left: 50%;
        transform: translateX(-50%);
        background: var(--success);
        color: white;
        padding: 0.75rem 1.5rem;
        border-radius: 8px;
        font-size: 0.9rem;
        font-weight: 500;
        z-index: 1000;
        animation: fadeInOut 2s ease;
      `;
      document.body.appendChild(toast);
      setTimeout(() => toast.remove(), 2000);
    }

    // Add animation keyframes
    const style = document.createElement('style');
    style.textContent = `
      @keyframes fadeInOut {
        0% { opacity: 0; transform: translateX(-50%) translateY(10px); }
        15% { opacity: 1; transform: translateX(-50%) translateY(0); }
        85% { opacity: 1; transform: translateX(-50%) translateY(0); }
        100% { opacity: 0; transform: translateX(-50%) translateY(-10px); }
      }
    `;
    document.head.appendChild(style);

    function showStatus(elementId, type, message) {
      const el = document.getElementById(elementId);
      el.innerHTML = `<div class="status status-${type}">${message}</div>`;
    }

    // ============================================
    // JSON to CSV Conversion
    // ============================================
    function flattenObject(obj, prefix = '') {
      const result = {};
      
      for (const key in obj) {
        if (!obj.hasOwnProperty(key)) continue;
        
        const newKey = prefix ? `${prefix}.${key}` : key;
        const value = obj[key];
        
        if (value === null || value === undefined) {
          result[newKey] = '';
        } else if (Array.isArray(value)) {
          // Join arrays with semicolon
          result[newKey] = value.map(v => {
            if (typeof v === 'object' && v !== null) {
              return JSON.stringify(v);
            }
            return String(v);
          }).join('; ');
        } else if (typeof value === 'object') {
          // Recursively flatten objects
          const flattened = flattenObject(value, newKey);
          Object.assign(result, flattened);
        } else {
          result[newKey] = value;
        }
      }
      
      return result;
    }

    function escapeCSVValue(value, delimiter) {
      if (value === null || value === undefined) return '';
      
      const str = String(value);
      const needsQuotes = str.includes(delimiter) || 
                          str.includes('"') || 
                          str.includes('\n') || 
                          str.includes('\r');
      
      if (needsQuotes) {
        return '"' + str.replace(/"/g, '""') + '"';
      }
      return str;
    }

    function convertJSONtoCSV() {
      const input = document.getElementById('jsonInput').value.trim();
      const statusEl = 'jsonToCsvStatus';
      
      if (!input) {
        showStatus(statusEl, 'warning', 'âš ï¸ Please enter some JSON data');
        return;
      }

      let data;
      try {
        data = JSON.parse(input);
      } catch (e) {
        showStatus(statusEl, 'error', `âŒ Invalid JSON: ${e.message}`);
        return;
      }

      // Ensure we have an array
      if (!Array.isArray(data)) {
        if (typeof data === 'object' && data !== null) {
          data = [data];
        } else {
          showStatus(statusEl, 'error', 'âŒ JSON must be an array of objects or a single object');
          return;
        }
      }

      if (data.length === 0) {
        showStatus(statusEl, 'warning', 'âš ï¸ JSON array is empty');
        return;
      }

      const delimiter = document.getElementById('delimiter').value;
      const flattenNested = document.getElementById('flattenNested').checked;
      const includeHeaders = document.getElementById('includeHeaders').checked;

      // Process rows
      const processedData = data.map(row => {
        if (flattenNested) {
          return flattenObject(row);
        }
        // If not flattening, stringify nested objects
        const result = {};
        for (const key in row) {
          const value = row[key];
          if (typeof value === 'object' && value !== null) {
            result[key] = JSON.stringify(value);
          } else {
            result[key] = value;
          }
        }
        return result;
      });

      // Collect all unique headers
      const headers = new Set();
      processedData.forEach(row => {
        Object.keys(row).forEach(key => headers.add(key));
      });
      const headerArray = Array.from(headers);

      // Build CSV
      const lines = [];
      
      if (includeHeaders) {
        lines.push(headerArray.map(h => escapeCSVValue(h, delimiter)).join(delimiter));
      }

      processedData.forEach(row => {
        const values = headerArray.map(header => {
          return escapeCSVValue(row[header], delimiter);
        });
        lines.push(values.join(delimiter));
      });

      const csv = lines.join('\n');
      document.getElementById('csvOutput').value = csv;

      // Show preview
      showCSVPreview(headerArray, processedData);

      showStatus(statusEl, 'success', `âœ“ Converted ${data.length} rows, ${headerArray.length} columns`);
    }

    function showCSVPreview(headers, data) {
      const preview = document.getElementById('csvPreview');
      const table = document.getElementById('csvPreviewTable');
      const stats = document.getElementById('csvPreviewStats');

      const maxPreviewRows = 10;
      const previewData = data.slice(0, maxPreviewRows);

      stats.textContent = `Showing ${previewData.length} of ${data.length} rows`;

      let html = '<thead><tr>';
      headers.forEach(h => {
        html += `<th>${escapeHTML(h)}</th>`;
      });
      html += '</tr></thead><tbody>';

      previewData.forEach(row => {
        html += '<tr>';
        headers.forEach(h => {
          const value = row[h] !== undefined ? row[h] : '';
          html += `<td title="${escapeHTML(String(value))}">${escapeHTML(String(value))}</td>`;
        });
        html += '</tr>';
      });
      html += '</tbody>';

      table.innerHTML = html;
      preview.classList.remove('hidden');
    }

    function escapeHTML(str) {
      return str.replace(/&/g, '&amp;')
                .replace(/</g, '&lt;')
                .replace(/>/g, '&gt;')
                .replace(/"/g, '&quot;');
    }

    function downloadCSV() {
      const csv = document.getElementById('csvOutput').value;
      if (!csv) return;

      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'data.csv';
      a.click();
      URL.revokeObjectURL(url);
    }

    // ============================================
    // CSV to JSON Conversion
    // ============================================
    function detectDelimiter(text) {
      const delimiters = [',', '\t', ';', '|'];
      const firstLine = text.split('\n')[0];
      
      let maxCount = 0;
      let detected = ',';
      
      delimiters.forEach(d => {
        const count = (firstLine.match(new RegExp(d === '|' ? '\\|' : d, 'g')) || []).length;
        if (count > maxCount) {
          maxCount = count;
          detected = d;
        }
      });
      
      return detected;
    }

    function parseCSVLine(line, delimiter) {
      const result = [];
      let current = '';
      let inQuotes = false;
      
      for (let i = 0; i < line.length; i++) {
        const char = line[i];
        const nextChar = line[i + 1];
        
        if (inQuotes) {
          if (char === '"') {
            if (nextChar === '"') {
              current += '"';
              i++; // Skip next quote
            } else {
              inQuotes = false;
            }
          } else {
            current += char;
          }
        } else {
          if (char === '"') {
            inQuotes = true;
          } else if (char === delimiter) {
            result.push(current);
            current = '';
          } else {
            current += char;
          }
        }
      }
      
      result.push(current);
      return result;
    }

    function parseCSV(text, delimiter) {
      const lines = [];
      let current = '';
      let inQuotes = false;
      
      for (let i = 0; i < text.length; i++) {
        const char = text[i];
        
        if (char === '"') {
          inQuotes = !inQuotes;
          current += char;
        } else if ((char === '\n' || char === '\r') && !inQuotes) {
          if (current.trim()) {
            lines.push(current);
          }
          current = '';
          // Skip \r\n as single newline
          if (char === '\r' && text[i + 1] === '\n') {
            i++;
          }
        } else {
          current += char;
        }
      }
      
      if (current.trim()) {
        lines.push(current);
      }
      
      return lines.map(line => parseCSVLine(line, delimiter));
    }

    function inferType(value) {
      if (value === '') return null;
      if (value.toLowerCase() === 'true') return true;
      if (value.toLowerCase() === 'false') return false;
      if (value.toLowerCase() === 'null') return null;
      
      // Check for number
      const num = Number(value);
      if (!isNaN(num) && value.trim() !== '') {
        return num;
      }
      
      return value;
    }

    function convertCSVtoJSON() {
      const input = document.getElementById('csvInput').value.trim();
      const statusEl = 'csvToJsonStatus';
      
      if (!input) {
        showStatus(statusEl, 'warning', 'âš ï¸ Please enter some CSV data');
        return;
      }

      const delimiterSetting = document.getElementById('csvDelimiter').value;
      const delimiter = delimiterSetting === 'auto' ? detectDelimiter(input) : delimiterSetting;
      const firstRowHeaders = document.getElementById('firstRowHeaders').checked;
      const inferTypes = document.getElementById('inferTypes').checked;

      const rows = parseCSV(input, delimiter);
      
      if (rows.length === 0) {
        showStatus(statusEl, 'error', 'âŒ No data found in CSV');
        return;
      }

      let headers;
      let dataRows;
      
      if (firstRowHeaders) {
        headers = rows[0].map(h => h.trim());
        dataRows = rows.slice(1);
      } else {
        headers = rows[0].map((_, i) => `column${i + 1}`);
        dataRows = rows;
      }

      const result = dataRows.map(row => {
        const obj = {};
        headers.forEach((header, i) => {
          let value = row[i] !== undefined ? row[i].trim() : '';
          if (inferTypes) {
            value = inferType(value);
          }
          obj[header] = value;
        });
        return obj;
      });

      const json = JSON.stringify(result, null, 2);
      document.getElementById('jsonOutput').value = json;

      showStatus(statusEl, 'success', `âœ“ Converted ${result.length} rows, ${headers.length} columns`);
    }

    function downloadJSON() {
      const json = document.getElementById('jsonOutput').value;
      if (!json) return;

      const blob = new Blob([json], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'data.json';
      a.click();
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
