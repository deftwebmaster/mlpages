<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Browser Fingerprint Viewer - What Your Browser Reveals</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --bg-dark: #0a0a0f;
      --bg-surface: #141420;
      --bg-elevated: #1a1a2e;
      --accent-primary: #00ff88;
      --accent-danger: #ff3366;
      --accent-warning: #ffaa00;
      --accent-info: #00aaff;
      --text-primary: #ffffff;
      --text-muted: #8b8b9e;
      --border: #2a2a3e;
      --shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
      --glow: 0 0 20px rgba(0, 255, 136, 0.3);
    }

    body {
      font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Fira Code', monospace;
      background: var(--bg-dark);
      color: var(--text-primary);
      line-height: 1.6;
      min-height: 100vh;
      padding: 2rem 1rem;
      background-image: 
        radial-gradient(circle at 20% 50%, rgba(0, 255, 136, 0.05) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(255, 51, 102, 0.05) 0%, transparent 50%);
    }

    .container {
      max-width: 1400px;
      margin: 0 auto;
    }

    /* Header */
    header {
      text-align: center;
      margin-bottom: 3rem;
      padding-bottom: 2rem;
      border-bottom: 1px solid var(--border);
    }

    h1 {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-info) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: -0.02em;
    }

    .subtitle {
      color: var(--text-muted);
      font-size: 1rem;
      margin-bottom: 1.5rem;
    }

    .warning-banner {
      background: rgba(255, 51, 102, 0.1);
      border: 1px solid rgba(255, 51, 102, 0.3);
      border-radius: 0.5rem;
      padding: 1rem 1.5rem;
      margin: 1.5rem auto;
      max-width: 800px;
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .warning-icon {
      font-size: 1.5rem;
      flex-shrink: 0;
    }

    .warning-text {
      font-size: 0.9rem;
      color: var(--text-muted);
    }

    /* Status Card */
    .status-card {
      background: var(--bg-surface);
      border: 1px solid var(--border);
      border-radius: 1rem;
      padding: 2rem;
      margin-bottom: 2rem;
      box-shadow: var(--shadow);
    }

    .status-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
    }

    .status-title {
      font-size: 1.2rem;
      font-weight: 600;
    }

    .scan-btn {
      background: linear-gradient(135deg, var(--accent-primary) 0%, var(--accent-info) 100%);
      color: var(--bg-dark);
      border: none;
      padding: 0.75rem 2rem;
      border-radius: 0.5rem;
      font-size: 1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s;
      font-family: inherit;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .scan-btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--glow);
    }

    .scan-btn:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .fingerprint-display {
      background: var(--bg-elevated);
      border: 1px solid var(--border);
      border-radius: 0.5rem;
      padding: 1.5rem;
      font-family: 'Courier New', monospace;
      font-size: 0.9rem;
      word-break: break-all;
      color: var(--accent-primary);
      margin-bottom: 1rem;
      position: relative;
      overflow: hidden;
    }

    .fingerprint-display::before {
      content: 'FINGERPRINT HASH';
      position: absolute;
      top: 0.5rem;
      right: 0.5rem;
      font-size: 0.7rem;
      color: var(--text-muted);
      letter-spacing: 0.1em;
    }

    .uniqueness-score {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
      margin-top: 1.5rem;
    }

    .score-item {
      background: var(--bg-elevated);
      border: 1px solid var(--border);
      border-radius: 0.5rem;
      padding: 1rem;
      text-align: center;
    }

    .score-value {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 0.25rem;
    }

    .score-value.high { color: var(--accent-danger); }
    .score-value.medium { color: var(--accent-warning); }
    .score-value.low { color: var(--accent-primary); }

    .score-label {
      font-size: 0.8rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    /* Scanning Progress */
    .scanning-progress {
      display: none;
      margin: 2rem 0;
    }

    .scanning-progress.active {
      display: block;
    }

    .progress-bar {
      background: var(--bg-elevated);
      border: 1px solid var(--border);
      border-radius: 0.5rem;
      height: 4px;
      overflow: hidden;
      margin-bottom: 1rem;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--accent-primary), var(--accent-info));
      width: 0%;
      transition: width 0.3s ease;
    }

    .current-scan {
      font-size: 0.9rem;
      color: var(--text-muted);
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .scan-spinner {
      width: 12px;
      height: 12px;
      border: 2px solid var(--accent-primary);
      border-top-color: transparent;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Results Grid */
    .results-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
      gap: 1.5rem;
      margin-top: 2rem;
    }

    .result-category {
      background: var(--bg-surface);
      border: 1px solid var(--border);
      border-radius: 1rem;
      padding: 1.5rem;
      box-shadow: var(--shadow);
      opacity: 0;
      transform: translateY(20px);
      animation: fadeInUp 0.5s forwards;
    }

    @keyframes fadeInUp {
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .category-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--border);
    }

    .category-title {
      font-size: 1.1rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .category-icon {
      font-size: 1.2rem;
    }

    .risk-badge {
      padding: 0.25rem 0.75rem;
      border-radius: 1rem;
      font-size: 0.75rem;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .risk-high {
      background: rgba(255, 51, 102, 0.2);
      color: var(--accent-danger);
      border: 1px solid var(--accent-danger);
    }

    .risk-medium {
      background: rgba(255, 170, 0, 0.2);
      color: var(--accent-warning);
      border: 1px solid var(--accent-warning);
    }

    .risk-low {
      background: rgba(0, 255, 136, 0.2);
      color: var(--accent-primary);
      border: 1px solid var(--accent-primary);
    }

    .data-point {
      margin-bottom: 1rem;
    }

    .data-label {
      font-size: 0.8rem;
      color: var(--text-muted);
      margin-bottom: 0.25rem;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .data-value {
      font-size: 0.95rem;
      color: var(--text-primary);
      word-break: break-word;
      font-family: 'Courier New', monospace;
      background: var(--bg-elevated);
      padding: 0.5rem 0.75rem;
      border-radius: 0.25rem;
      border: 1px solid var(--border);
    }

    .data-explanation {
      font-size: 0.85rem;
      color: var(--text-muted);
      margin-top: 0.5rem;
      font-style: italic;
      line-height: 1.4;
    }

    /* Action Buttons */
    .actions {
      display: flex;
      gap: 1rem;
      margin-top: 2rem;
      flex-wrap: wrap;
    }

    .btn {
      padding: 0.75rem 1.5rem;
      border: 1px solid var(--border);
      border-radius: 0.5rem;
      background: var(--bg-surface);
      color: var(--text-primary);
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      font-family: inherit;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .btn:hover {
      background: var(--bg-elevated);
      border-color: var(--accent-primary);
      transform: translateY(-2px);
    }

    /* Mitigation Tips */
    .tips-section {
      background: var(--bg-surface);
      border: 1px solid var(--border);
      border-radius: 1rem;
      padding: 2rem;
      margin-top: 3rem;
      box-shadow: var(--shadow);
    }

    .tips-title {
      font-size: 1.3rem;
      font-weight: 600;
      margin-bottom: 1.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .tip-item {
      background: var(--bg-elevated);
      border-left: 3px solid var(--accent-primary);
      padding: 1rem 1.5rem;
      margin-bottom: 1rem;
      border-radius: 0.25rem;
    }

    .tip-title {
      font-weight: 600;
      margin-bottom: 0.5rem;
      color: var(--accent-primary);
    }

    .tip-description {
      color: var(--text-muted);
      font-size: 0.9rem;
      line-height: 1.6;
    }

    /* Responsive */
    @media (max-width: 768px) {
      h1 {
        font-size: 1.8rem;
      }

      .results-grid {
        grid-template-columns: 1fr;
      }

      .status-header {
        flex-direction: column;
        gap: 1rem;
      }

      .scan-btn {
        width: 100%;
      }
    }

    /* Hidden */
    .hidden {
      display: none !important;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>üîç Browser Fingerprint Viewer</h1>
      <p class="subtitle">Discover what your browser reveals about you</p>
      
      <div class="warning-banner">
        <span class="warning-icon">‚ö†Ô∏è</span>
        <div class="warning-text">
          <strong>Privacy Alert:</strong> Your browser leaks a unique digital fingerprint that can track you across the web - even without cookies. This tool shows you exactly what's exposed.
        </div>
      </div>
    </header>

    <!-- Status Card -->
    <div class="status-card">
      <div class="status-header">
        <h2 class="status-title">Your Digital Fingerprint</h2>
        <button id="scan-btn" class="scan-btn">Start Scan</button>
      </div>

      <div id="scanning-progress" class="scanning-progress">
        <div class="progress-bar">
          <div id="progress-fill" class="progress-fill"></div>
        </div>
        <div class="current-scan">
          <div class="scan-spinner"></div>
          <span id="current-scan-text">Initializing scan...</span>
        </div>
      </div>

      <div id="results-summary" class="hidden">
        <div class="fingerprint-display" id="fingerprint-hash">
          <!-- Hash will be inserted here -->
        </div>

        <div class="uniqueness-score">
          <div class="score-item">
            <div class="score-value high" id="uniqueness-score">--</div>
            <div class="score-label">Uniqueness Score</div>
          </div>
          <div class="score-item">
            <div class="score-value medium" id="entropy-bits">--</div>
            <div class="score-label">Entropy Bits</div>
          </div>
          <div class="score-item">
            <div class="score-value low" id="data-points">--</div>
            <div class="score-label">Data Points</div>
          </div>
        </div>

        <div class="actions">
          <button class="btn" id="export-btn">üì• Export JSON</button>
          <button class="btn" id="rescan-btn">üîÑ Scan Again</button>
          <button class="btn" id="copy-hash-btn">üìã Copy Hash</button>
        </div>
      </div>
    </div>

    <!-- Results Grid -->
    <div id="results-grid" class="results-grid hidden">
      <!-- Results will be dynamically inserted here -->
    </div>

    <!-- Mitigation Tips -->
    <div id="tips-section" class="tips-section hidden">
      <h3 class="tips-title">üõ°Ô∏è How to Reduce Your Fingerprint</h3>
      
      <div class="tip-item">
        <div class="tip-title">Use Privacy-Focused Browsers</div>
        <div class="tip-description">
          Browsers like Brave, Firefox with privacy extensions, or Tor Browser actively resist fingerprinting by normalizing or randomizing detectable attributes.
        </div>
      </div>

      <div class="tip-item">
        <div class="tip-title">Disable WebGL & Canvas</div>
        <div class="tip-description">
          These are major fingerprinting vectors. Use browser extensions like CanvasBlocker or configure Firefox's privacy.resistFingerprinting setting.
        </div>
      </div>

      <div class="tip-item">
        <div class="tip-title">Limit Browser Extensions</div>
        <div class="tip-description">
          Each extension can be detected and adds to your unique fingerprint. Only install essential extensions and use them in private/incognito mode sparingly.
        </div>
      </div>

      <div class="tip-item">
        <div class="tip-title">Use VPN + Privacy Mode</div>
        <div class="tip-description">
          While VPNs hide your IP, combine them with private browsing and fingerprint resistance for maximum privacy. Your fingerprint can still identify you even behind a VPN.
        </div>
      </div>

      <div class="tip-item">
        <div class="tip-title">Regular Browser Rotation</div>
        <div class="tip-description">
          Switch between different browsers and devices for sensitive activities. This makes it harder to build a consistent profile of your browsing behavior.
        </div>
      </div>
    </div>
  </div>

  <script>
    // Fingerprinting Engine
    const FingerprintScanner = {
      results: {},
      fingerprint: '',
      
      // Hash function
      async hashString(str) {
        const encoder = new TextEncoder();
        const data = encoder.encode(str);
        const hashBuffer = await crypto.subtle.digest('SHA-256', data);
        const hashArray = Array.from(new Uint8Array(hashBuffer));
        return hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
      },

      // Basic browser info
      async scanBasicInfo() {
        return {
          userAgent: navigator.userAgent,
          language: navigator.language,
          languages: navigator.languages.join(', '),
          platform: navigator.platform,
          hardwareConcurrency: navigator.hardwareConcurrency || 'Unknown',
          deviceMemory: navigator.deviceMemory || 'Unknown',
          cookieEnabled: navigator.cookieEnabled,
          doNotTrack: navigator.doNotTrack || 'Not set',
          maxTouchPoints: navigator.maxTouchPoints || 0
        };
      },

      // Screen & display info
      async scanScreen() {
        return {
          screenResolution: `${screen.width}x${screen.height}`,
          availableResolution: `${screen.availWidth}x${screen.availHeight}`,
          colorDepth: screen.colorDepth,
          pixelDepth: screen.pixelDepth,
          devicePixelRatio: window.devicePixelRatio,
          orientation: screen.orientation?.type || 'Unknown'
        };
      },

      // Timezone detection
      async scanTimezone() {
        const offset = new Date().getTimezoneOffset();
        const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
        return {
          timezone: timezone,
          timezoneOffset: offset,
          timestamp: new Date().toISOString()
        };
      },

      // Canvas fingerprinting
      async scanCanvas() {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = 200;
        canvas.height = 50;

        // Draw unique pattern
        ctx.textBaseline = 'top';
        ctx.font = '14px "Arial"';
        ctx.textBaseline = 'alphabetic';
        ctx.fillStyle = '#f60';
        ctx.fillRect(125, 1, 62, 20);
        ctx.fillStyle = '#069';
        ctx.fillText('Browser Fingerprint üîç', 2, 15);
        ctx.fillStyle = 'rgba(102, 204, 0, 0.7)';
        ctx.fillText('Canvas Test', 4, 17);

        const dataURL = canvas.toDataURL();
        const hash = await this.hashString(dataURL);
        
        return {
          canvasHash: hash.substring(0, 16),
          canvasSupported: true
        };
      },

      // WebGL fingerprinting
      async scanWebGL() {
        const canvas = document.createElement('canvas');
        const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
        
        if (!gl) {
          return { webGLSupported: false };
        }

        const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
        
        return {
          webGLSupported: true,
          vendor: gl.getParameter(gl.VENDOR),
          renderer: debugInfo ? gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) : 'Unknown',
          version: gl.getParameter(gl.VERSION),
          shadingLanguageVersion: gl.getParameter(gl.SHADING_LANGUAGE_VERSION),
          extensions: gl.getSupportedExtensions().length
        };
      },

      // Audio fingerprinting
      async scanAudio() {
        try {
          const AudioContext = window.AudioContext || window.webkitAudioContext;
          const context = new AudioContext();
          const oscillator = context.createOscillator();
          const analyser = context.createAnalyser();
          const gainNode = context.createGain();
          const scriptProcessor = context.createScriptProcessor(4096, 1, 1);

          gainNode.gain.value = 0; // Mute
          oscillator.connect(analyser);
          analyser.connect(scriptProcessor);
          scriptProcessor.connect(gainNode);
          gainNode.connect(context.destination);

          oscillator.start(0);
          
          const audioData = await new Promise((resolve) => {
            scriptProcessor.onaudioprocess = function(event) {
              const output = event.outputBuffer.getChannelData(0);
              resolve(Array.from(output.slice(0, 30)).join(','));
              oscillator.stop();
              scriptProcessor.disconnect();
            };
          });

          const hash = await this.hashString(audioData);

          return {
            audioHash: hash.substring(0, 16),
            audioSupported: true
          };
        } catch (e) {
          return { audioSupported: false };
        }
      },

      // Font detection
      async scanFonts() {
        const baseFonts = ['monospace', 'sans-serif', 'serif'];
        const testFonts = [
          'Arial', 'Verdana', 'Times New Roman', 'Courier New', 'Georgia',
          'Palatino', 'Garamond', 'Bookman', 'Comic Sans MS', 'Trebuchet MS',
          'Impact', 'Lucida Console', 'Tahoma', 'Helvetica', 'Calibri'
        ];

        const testString = 'mmmmmmmmmmlli';
        const testSize = '72px';
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');

        const baselines = {};
        baseFonts.forEach(baseFont => {
          ctx.font = testSize + ' ' + baseFont;
          baselines[baseFont] = ctx.measureText(testString).width;
        });

        const detectedFonts = [];
        testFonts.forEach(font => {
          let detected = false;
          baseFonts.forEach(baseFont => {
            ctx.font = testSize + ' ' + font + ',' + baseFont;
            const width = ctx.measureText(testString).width;
            if (width !== baselines[baseFont]) {
              detected = true;
            }
          });
          if (detected) {
            detectedFonts.push(font);
          }
        });

        return {
          fontsDetected: detectedFonts.length,
          sampleFonts: detectedFonts.slice(0, 5).join(', ')
        };
      },

      // Storage & Permissions
      async scanStorage() {
        return {
          localStorage: typeof localStorage !== 'undefined',
          sessionStorage: typeof sessionStorage !== 'undefined',
          indexedDB: typeof indexedDB !== 'undefined',
          cookiesEnabled: navigator.cookieEnabled
        };
      },

      // Network info
      async scanNetwork() {
        const connection = navigator.connection || navigator.mozConnection || navigator.webkitConnection;
        
        return {
          effectiveType: connection?.effectiveType || 'Unknown',
          downlink: connection?.downlink || 'Unknown',
          rtt: connection?.rtt || 'Unknown',
          saveData: connection?.saveData || false
        };
      },

      // Battery API
      async scanBattery() {
        try {
          if (navigator.getBattery) {
            const battery = await navigator.getBattery();
            return {
              charging: battery.charging,
              level: Math.round(battery.level * 100) + '%',
              chargingTime: battery.chargingTime === Infinity ? 'N/A' : battery.chargingTime,
              dischargingTime: battery.dischargingTime === Infinity ? 'N/A' : battery.dischargingTime
            };
          }
        } catch (e) {
          return { batterySupported: false };
        }
        return { batterySupported: false };
      },

      // Media devices
      async scanMediaDevices() {
        try {
          if (navigator.mediaDevices && navigator.mediaDevices.enumerateDevices) {
            const devices = await navigator.mediaDevices.enumerateDevices();
            return {
              videoInputs: devices.filter(d => d.kind === 'videoinput').length,
              audioInputs: devices.filter(d => d.kind === 'audioinput').length,
              audioOutputs: devices.filter(d => d.kind === 'audiooutput').length
            };
          }
        } catch (e) {
          return { mediaDevicesSupported: false };
        }
        return { mediaDevicesSupported: false };
      },

      // Generate overall fingerprint hash
      async generateFingerprint() {
        const fingerprintString = JSON.stringify(this.results);
        this.fingerprint = await this.hashString(fingerprintString);
        return this.fingerprint;
      },

      // Calculate entropy (uniqueness bits)
      calculateEntropy() {
        let bits = 0;
        
        // Each unique characteristic adds entropy
        if (this.results.basicInfo) bits += 8; // User agent varies widely
        if (this.results.screen) bits += 6; // Screen resolution
        if (this.results.canvas) bits += 10; // Canvas is highly unique
        if (this.results.webgl) bits += 8; // WebGL renderer
        if (this.results.audio) bits += 6; // Audio fingerprint
        if (this.results.fonts) bits += 5; // Font detection
        if (this.results.timezone) bits += 4; // Timezone
        if (this.results.battery) bits += 2; // Battery status
        if (this.results.mediaDevices) bits += 3; // Media devices
        
        return bits;
      }
    };

    // UI Controller
    const UI = {
      scanBtn: document.getElementById('scan-btn'),
      scanProgress: document.getElementById('scanning-progress'),
      progressFill: document.getElementById('progress-fill'),
      currentScanText: document.getElementById('current-scan-text'),
      resultsSummary: document.getElementById('results-summary'),
      resultsGrid: document.getElementById('results-grid'),
      tipsSection: document.getElementById('tips-section'),
      fingerprintHash: document.getElementById('fingerprint-hash'),
      uniquenessScore: document.getElementById('uniqueness-score'),
      entropyBits: document.getElementById('entropy-bits'),
      dataPoints: document.getElementById('data-points'),

      init() {
        this.scanBtn.addEventListener('click', () => this.startScan());
        document.getElementById('export-btn')?.addEventListener('click', () => this.exportResults());
        document.getElementById('rescan-btn')?.addEventListener('click', () => this.startScan());
        document.getElementById('copy-hash-btn')?.addEventListener('click', () => this.copyHash());
      },

      async startScan() {
        this.scanBtn.disabled = true;
        this.scanProgress.classList.add('active');
        this.resultsSummary.classList.add('hidden');
        this.resultsGrid.classList.add('hidden');
        this.tipsSection.classList.add('hidden');
        this.resultsGrid.innerHTML = '';

        const scans = [
          { name: 'Basic Browser Info', fn: 'scanBasicInfo', key: 'basicInfo' },
          { name: 'Screen & Display', fn: 'scanScreen', key: 'screen' },
          { name: 'Timezone Data', fn: 'scanTimezone', key: 'timezone' },
          { name: 'Canvas Fingerprint', fn: 'scanCanvas', key: 'canvas' },
          { name: 'WebGL Capabilities', fn: 'scanWebGL', key: 'webgl' },
          { name: 'Audio Fingerprint', fn: 'scanAudio', key: 'audio' },
          { name: 'Font Detection', fn: 'scanFonts', key: 'fonts' },
          { name: 'Storage APIs', fn: 'scanStorage', key: 'storage' },
          { name: 'Network Info', fn: 'scanNetwork', key: 'network' },
          { name: 'Battery Status', fn: 'scanBattery', key: 'battery' },
          { name: 'Media Devices', fn: 'scanMediaDevices', key: 'mediaDevices' }
        ];

        for (let i = 0; i < scans.length; i++) {
          const scan = scans[i];
          this.currentScanText.textContent = `Scanning: ${scan.name}...`;
          this.progressFill.style.width = `${((i + 1) / scans.length) * 100}%`;
          
          FingerprintScanner.results[scan.key] = await FingerprintScanner[scan.fn]();
          await this.delay(300); // Dramatic pause
        }

        this.currentScanText.textContent = 'Generating fingerprint hash...';
        await FingerprintScanner.generateFingerprint();
        await this.delay(500);

        this.displayResults();
      },

      delay(ms) {
        return new Promise(resolve => setTimeout(resolve, ms));
      },

      displayResults() {
        this.scanProgress.classList.remove('active');
        this.resultsSummary.classList.remove('hidden');
        this.resultsGrid.classList.remove('hidden');
        this.tipsSection.classList.remove('hidden');
        this.scanBtn.disabled = false;

        // Display hash
        this.fingerprintHash.textContent = FingerprintScanner.fingerprint;

        // Calculate scores
        const entropy = FingerprintScanner.calculateEntropy();
        const dataPoints = Object.keys(FingerprintScanner.results).length;
        const uniqueness = Math.min(99.9, (entropy / 60) * 100).toFixed(1);

        this.uniquenessScore.textContent = uniqueness + '%';
        this.entropyBits.textContent = entropy;
        this.dataPoints.textContent = dataPoints;

        // Render categories
        this.renderCategory('üåê Basic Info', FingerprintScanner.results.basicInfo, 'medium', 
          'User agent and language settings can identify your browser and OS. Combined with other data, this creates a unique profile.');
        
        this.renderCategory('üñ•Ô∏è Screen & Display', FingerprintScanner.results.screen, 'medium',
          'Screen resolution and pixel ratio are highly identifying, especially on less common displays.');
        
        this.renderCategory('üïê Timezone', FingerprintScanner.results.timezone, 'low',
          'Timezone narrows down your location and adds to fingerprint uniqueness.');
        
        this.renderCategory('üé® Canvas Fingerprint', FingerprintScanner.results.canvas, 'high',
          'Canvas rendering is highly unique due to GPU and driver differences. This is a major tracking vector.');
        
        this.renderCategory('üéÆ WebGL', FingerprintScanner.results.webgl, 'high',
          'WebGL exposes GPU information and capabilities, creating a highly unique identifier.');
        
        this.renderCategory('üîä Audio', FingerprintScanner.results.audio, 'high',
          'Audio processing creates unique signatures based on hardware and drivers.');
        
        this.renderCategory('üî§ Fonts', FingerprintScanner.results.fonts, 'medium',
          'Installed fonts vary by user and system, adding significant entropy to your fingerprint.');
        
        this.renderCategory('üíæ Storage', FingerprintScanner.results.storage, 'low',
          'Storage API availability is consistent but still adds to your profile.');
        
        this.renderCategory('üì° Network', FingerprintScanner.results.network, 'low',
          'Connection type and speed can change but provide additional tracking data.');
        
        if (FingerprintScanner.results.battery.batterySupported !== false) {
          this.renderCategory('üîã Battery', FingerprintScanner.results.battery, 'medium',
            'Battery status can be used for tracking and adds uniqueness to your fingerprint.');
        }
        
        if (FingerprintScanner.results.mediaDevices.mediaDevicesSupported !== false) {
          this.renderCategory('üé• Media Devices', FingerprintScanner.results.mediaDevices, 'low',
            'Number and type of media devices (cameras, microphones) adds to your fingerprint.');
        }
      },

      renderCategory(title, data, risk, explanation) {
        const icon = title.split(' ')[0];
        const name = title.substring(title.indexOf(' ') + 1);
        
        const card = document.createElement('div');
        card.className = 'result-category';
        card.style.animationDelay = `${Math.random() * 0.3}s`;

        let dataHTML = '';
        for (const [key, value] of Object.entries(data)) {
          dataHTML += `
            <div class="data-point">
              <div class="data-label">${this.formatLabel(key)}</div>
              <div class="data-value">${this.formatValue(value)}</div>
            </div>
          `;
        }

        card.innerHTML = `
          <div class="category-header">
            <div class="category-title">
              <span class="category-icon">${icon}</span>
              ${name}
            </div>
            <span class="risk-badge risk-${risk}">${risk} risk</span>
          </div>
          ${dataHTML}
          <div class="data-explanation">${explanation}</div>
        `;

        this.resultsGrid.appendChild(card);
      },

      formatLabel(key) {
        return key
          .replace(/([A-Z])/g, ' $1')
          .replace(/^./, str => str.toUpperCase())
          .trim();
      },

      formatValue(value) {
        if (typeof value === 'boolean') {
          return value ? '‚úì Yes' : '‚úó No';
        }
        if (value === 'Unknown' || value === null || value === undefined) {
          return 'N/A';
        }
        return String(value);
      },

      exportResults() {
        const data = {
          fingerprint: FingerprintScanner.fingerprint,
          timestamp: new Date().toISOString(),
          results: FingerprintScanner.results,
          entropy: FingerprintScanner.calculateEntropy()
        };

        const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `fingerprint-${Date.now()}.json`;
        a.click();
        URL.revokeObjectURL(url);
      },

      async copyHash() {
        try {
          await navigator.clipboard.writeText(FingerprintScanner.fingerprint);
          const btn = document.getElementById('copy-hash-btn');
          const originalText = btn.textContent;
          btn.textContent = '‚úì Copied!';
          setTimeout(() => {
            btn.textContent = originalText;
          }, 2000);
        } catch (e) {
          alert('Failed to copy hash');
        }
      }
    };

    // Initialize
    UI.init();
  </script>
</body>
</html>
